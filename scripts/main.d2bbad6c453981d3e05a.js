(()=>{"use strict";var e,t={5768:(e,t,r)=>{var n=r(3935),o=r(9704),a=r(9711),l=r(5974),i=r(2287),s=r(6403),c=r(9084);const d=(0,s.oM)({name:"user",initialState:{user:null,users:[],media:{audio:!0,video:!0},loading:{user:!1,users:!1},error:{user:null,users:null},audioInDevice:"",audioOutDevice:"",friends:[],invites:[],approvals:[],isCall:!1,isIncomingCall:!1,isCallAccepted:!1,isCallCanceled:!1,channels:[],channelMessages:[]},reducers:{requestGetUserAction:e=>{e.loading.user=!0},successGetUserAction:(e,{payload:t})=>{e.user=t,e.loading.user=!1},failureGetUserAction:(e,{payload:t})=>{e.error.user=t,e.loading.user=!1},requestUpdateUserAction:(e,{payload:t})=>{e.loading.user=!0},successUpdateUserAction:(e,{payload:t})=>{e.user=t,e.loading.user=!1},failureUpdateUserAction:(e,{payload:t})=>{e.error.user=t,e.loading.user=!1},requestGetUsersAction:e=>{e.loading.users=!0},successGetUsersAction:(e,{payload:t})=>{e.users=t,e.loading.users=!1},failureGetUsersAction:(e,{payload:t})=>{e.error.users=t,e.loading.users=!1},setIsCall:(e,{payload:t})=>{e.isCall=t},setIsIncomingCall:(e,{payload:t})=>{e.isIncomingCall=t},setIsCallAccepted:(e,{payload:t})=>{e.isCallAccepted=t},setIsCallCanceled:(e,{payload:t})=>{e.isCallCanceled=t},setAudioInDevice:(e,{payload:t})=>{e.audioInDevice=t},setAudioOutDevice:(e,{payload:t})=>{e.audioOutDevice=t},setMediaAction:(e,{payload:t})=>{e.media=t}}}),{setIsCall:p,setIsIncomingCall:u,setIsCallAccepted:m,setIsCallCanceled:g,requestGetUserAction:f,successGetUserAction:x,failureGetUserAction:v,requestUpdateUserAction:h,successUpdateUserAction:E,failureUpdateUserAction:b,setAudioInDevice:y,setAudioOutDevice:Z,requestGetUsersAction:k,successGetUsersAction:C,failureGetUsersAction:w,setMediaAction:_}=d.actions,S=d.reducer;var I=r(4857),A=r(9669),T=r.n(A);const G="https://ioinitid-video-calls-server.herokuapp.com",z="client:connect",O="client:disconnect",R="server:connect",j="server:disconnect",L={Registration:"/registration",Authorization:"/authorization",Refresh:`${G}/api/refresh`,Logout:"/logout"},P=e=>te.request({method:"POST",url:L.Registration,data:e}),F=e=>te.request({method:"POST",url:L.Authorization,data:e}),M=e=>T().request({method:"POST",url:L.Refresh,data:e}),D=()=>te.request({method:"GET",url:L.Logout}),q=(0,s.oM)({name:"authorization",initialState:{access_token:"",refresh_token:"",authorizated:!1,loading:{access_token:!1,refresh_token:!1},error:{access_token:null,refresh_token:null}},reducers:{requestRegistrationAction:(e,{payload:t})=>{e.loading.access_token=!0,e.loading.refresh_token=!0},successRegistrationAction:(e,{payload:t})=>{e.access_token=t.access_token,e.refresh_token=t.refresh_token,e.authorizated=!0,e.loading.access_token=!1,e.loading.refresh_token=!1,e.error.access_token=null,e.error.refresh_token=null,localStorage.setItem("access_token",t.access_token),localStorage.setItem("refresh_token",t.refresh_token)},failureRegistrationAction:(e,{payload:t})=>{e.loading.access_token=!1,e.loading.refresh_token=!1,e.error.access_token=t.error,e.error.refresh_token=t.error},requestAuthorizationAction:(e,{payload:t})=>{e.loading.access_token=!0,e.loading.refresh_token=!0},successAuthorizationAction:(e,{payload:t})=>{e.access_token=t.access_token,e.refresh_token=t.refresh_token,e.authorizated=!0,e.loading.access_token=!1,e.loading.refresh_token=!1,e.error.access_token=null,e.error.refresh_token=null,localStorage.setItem("access_token",t.access_token),localStorage.setItem("refresh_token",t.refresh_token)},failureAuthorizationAction:(e,{payload:t})=>{e.loading.access_token=!1,e.loading.refresh_token=!1,e.error.access_token=t.error,e.error.refresh_token=t.error},requestRefreshAction:(e,{payload:t})=>{e.loading.access_token=!0,e.loading.refresh_token=!0},successRefreshAction:(e,{payload:t})=>{e.access_token=t.access_token,e.refresh_token=t.refresh_token,e.authorizated=!0,e.loading.access_token=!1,e.loading.refresh_token=!1,e.error.access_token=null,e.error.refresh_token=null,localStorage.setItem("access_token",t.access_token),localStorage.setItem("refresh_token",t.refresh_token)},failureRefreshAction:(e,{payload:t})=>{e.access_token="",e.refresh_token="",e.authorizated=!1,e.loading.access_token=!1,e.loading.refresh_token=!1,e.error.access_token=t.error,e.error.refresh_token=t.error,localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")},requestLogoutAction:e=>{e.loading.access_token=!0},successLogoutAction:e=>{e.access_token="",e.refresh_token="",e.authorizated=!1,e.loading.access_token=!1,e.loading.refresh_token=!1,e.error.access_token=null,e.error.refresh_token=null,localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")},failureLogoutAction:(e,{payload:t})=>{e.loading.access_token=!1,e.loading.refresh_token=!1,e.error.access_token=t.error,e.error.refresh_token=t.error}}}),{requestRegistrationAction:$,successRegistrationAction:W,failureRegistrationAction:U,requestAuthorizationAction:B,successAuthorizationAction:N,failureAuthorizationAction:V,requestRefreshAction:H,successRefreshAction:Y,failureRefreshAction:X,requestLogoutAction:J,successLogoutAction:K,failureLogoutAction:Q}=q.actions,ee=q.reducer,te=T().create({withCredentials:!0,baseURL:`${G}/api`});te.interceptors.request.use((e=>(e.headers&&(e.headers.Authorization=`Bearer ${localStorage.getItem("access_token")||""}`),e)),(e=>Promise.reject(e))),te.interceptors.response.use((e=>e),(e=>{return void 0,null,t=function*(){const t=e.config;if(e.response){if(401===e.response.status&&!t._retry){t._retry=!0;try{const e=localStorage.getItem("refresh_token");if(e){const t=yield M({refresh_token:e});mt.dispatch(Y({access_token:t.data.access_token,refresh_token:t.data.refresh_token}))}}catch(e){return mt.dispatch(X(e)),Promise.reject(e)}return te(t)}if(401!==e.response.status)return Promise.reject(e.response.data)}return Promise.reject(e)},new Promise(((e,r)=>{var n=e=>{try{a(t.next(e))}catch(e){r(e)}},o=e=>{try{a(t.throw(e))}catch(e){r(e)}},a=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,o);a((t=t.apply(undefined,null)).next())}));var t}));const re="/user",ne=()=>te.request({method:"GET",url:re}),oe=e=>te.request({method:"PATCH",url:re,data:e}),ae=()=>te.request({method:"GET",url:"/users"}),le=function*(){try{const e=yield(0,I.RE)(ne);yield(0,I.gz)(x(e.data))}catch(e){console.error(e),yield(0,I.gz)(v(e))}},ie=function*({payload:e}){try{const t=yield(0,I.RE)(oe,e);yield(0,I.gz)(E(t.data))}catch(e){console.error(e),yield(0,I.gz)(b(e))}},se=function*(){try{const e=yield(0,I.RE)(ae);yield(0,I.gz)(C(e.data))}catch(e){console.error(e)}},ce=function*({payload:e}){try{const t=yield(0,I.RE)(P,e);yield(0,I.gz)(W({access_token:t.data.access_token,refresh_token:t.data.refresh_token}))}catch(e){console.error(e),yield(0,I.gz)(U({error:e}))}},de=function*({payload:e}){try{const t=yield(0,I.RE)(F,e);yield(0,I.gz)(N({access_token:t.data.access_token,refresh_token:t.data.refresh_token}))}catch(e){console.error(e),yield(0,I.gz)(V({error:e}))}},pe=function*({payload:e}){try{const t=yield(0,I.RE)(M,e);yield(0,I.gz)(Y({access_token:t.data.access_token,refresh_token:t.data.refresh_token}))}catch(e){console.error(e),yield(0,I.gz)(X({error:e}))}},ue=function*(){try{yield(0,I.RE)(D),yield(0,I.gz)(K())}catch(e){console.error(e),yield(0,I.gz)(Q({error:e}))}},me=(0,s.oM)({name:"friends",initialState:{friends:[],friends_users:[],status:{friends:"idle",friends_users:"idle",add_to_friends:"idle",remove_from_friends:"idle"},loading:{friends:!1,friends_users:!1,add_to_friends:!1,remove_from_friends:!1},error:{friends:null,friends_users:null,add_to_friends:null,remove_from_friends:null}},reducers:{requestGetFriendsAction:e=>{e.status.friends="running",e.loading.friends=!0},successGetFriendsAction:(e,{payload:t})=>{e.friends=t,e.status.friends="success",e.loading.friends=!1,e.error.friends=null},failureGetFriendsAction:(e,{payload:t})=>{e.status.friends="error",e.loading.friends=!1,e.error.friends=t},requestGetFriendsUsersAction:e=>{e.status.friends_users="running",e.loading.friends_users=!0},successGetFriendsUsersAction:(e,{payload:t})=>{e.friends_users=t,e.status.friends_users="success",e.loading.friends_users=!1,e.error.friends_users=null},failureGetFriendsUsersAction:(e,{payload:t})=>{e.status.friends_users="error",e.loading.friends_users=!1,e.error.friends_users=t},requestAddToFriendsAction:(e,{payload:t})=>{e.status.add_to_friends="running",e.loading.add_to_friends=!0},successAddToFriendsAction:(e,{payload:t})=>{e.friends=t,e.status.add_to_friends="success",e.loading.add_to_friends=!1,e.error.add_to_friends=null},failureAddToFriendsAction:(e,{payload:t})=>{e.status.add_to_friends="error",e.loading.add_to_friends=!1,e.error.add_to_friends=t},requestRemoveFromFriendsAction:(e,{payload:t})=>{e.status.remove_from_friends="running",e.loading.remove_from_friends=!0},successRemoveFromFriendsAction:(e,{payload:t})=>{e.friends=t,e.status.remove_from_friends="success",e.loading.remove_from_friends=!1,e.error.remove_from_friends=null},failureRemoveFromFriendsAction:(e,{payload:t})=>{e.status.remove_from_friends="error",e.loading.remove_from_friends=!1,e.error.remove_from_friends=t}}}),{requestGetFriendsAction:ge,successGetFriendsAction:fe,failureGetFriendsAction:xe,requestAddToFriendsAction:ve,successAddToFriendsAction:he,failureAddToFriendsAction:Ee,requestRemoveFromFriendsAction:be,successRemoveFromFriendsAction:ye,failureRemoveFromFriendsAction:Ze,requestGetFriendsUsersAction:ke,successGetFriendsUsersAction:Ce,failureGetFriendsUsersAction:we}=me.actions,_e=me.reducer,Se=()=>te.request({method:"GET",url:"/friends"}),Ie=()=>te.request({method:"GET",url:"/friends/users"}),Ae=e=>te.request({method:"POST",url:"/friends/add",data:e}),Te=e=>te.request({method:"POST",url:"/friends/remove",data:e}),Ge=(0,r(3213).io)(G,{transports:["websocket"]}),ze="client:add_to_friends",Oe="client:remove_from_friends",Re="server:add_to_friends",je="server:remove_from_friends",Le=function*(){try{const e=yield(0,I.RE)(Se);yield(0,I.gz)(fe(e.data.friends))}catch(e){console.error(e),yield(0,I.gz)(xe(e))}},Pe=function*(){try{const e=yield(0,I.RE)(Ie);yield(0,I.gz)(Ce(e.data.friends_users))}catch(e){console.error(e),yield(0,I.gz)(we(e))}},Fe=function*({payload:e}){try{const t=yield(0,I.RE)(Ae,e);yield(0,I.gz)(he(t.data.friends)),Ge.emit(ze,e.friend_id)}catch(e){console.error(e),yield(0,I.gz)(Ee(e))}},Me=function*({payload:e}){try{const t=yield(0,I.RE)(Te,e);yield(0,I.gz)(ye(t.data.friends)),Ge.emit(Oe,e.friend_id)}catch(e){console.error(e),yield(0,I.gz)(Ze(e))}},De=()=>te.request({method:"GET",url:"/invitations"}),qe=e=>te.request({method:"POST",url:"/invitations/sent",data:e}),$e=e=>te.request({method:"POST",url:"/invitations/decline",data:e}),We=(0,s.oM)({name:"invitations",initialState:{invitations:{sent:[],received:[]},status:{invitations:"idle",sent_invitations:"idle",decline_invitations:"idle"},loading:{invitations:!1,sent_invitations:!1,decline_invitations:!1},error:{invitations:null,sent_invitations:null,decline_invitations:null}},reducers:{requestGetInvitationsAction:e=>{e.status.invitations="running",e.loading.invitations=!0},successGetInvitationsAction:(e,{payload:t})=>{e.invitations=t,e.status.invitations="success",e.loading.invitations=!1,e.error.invitations=null},failureGetInvitationsAction:(e,{payload:t})=>{e.status.invitations="error",e.loading.invitations=!1,e.error.invitations=t},requestSentInvitationsAction:(e,{payload:t})=>{e.status.sent_invitations="running",e.loading.sent_invitations=!0},successSentInvitationsAction:(e,{payload:t})=>{e.invitations=t,e.status.sent_invitations="success",e.loading.sent_invitations=!1,e.error.sent_invitations=null},failureSentInvitationsAction:(e,{payload:t})=>{e.status.sent_invitations="error",e.loading.sent_invitations=!1,e.error.sent_invitations=t},requestDeclineInvitationsAction:(e,{payload:t})=>{e.status.decline_invitations="running",e.loading.decline_invitations=!0},successDeclineInvitationsAction:(e,{payload:t})=>{e.invitations=t,e.status.decline_invitations="success",e.loading.decline_invitations=!1,e.error.decline_invitations=null},failureDeclineInvitationsAction:(e,{payload:t})=>{e.status.decline_invitations="error",e.loading.decline_invitations=!1,e.error.decline_invitations=t}}}),{requestGetInvitationsAction:Ue,successGetInvitationsAction:Be,failureGetInvitationsAction:Ne,requestSentInvitationsAction:Ve,successSentInvitationsAction:He,failureSentInvitationsAction:Ye,requestDeclineInvitationsAction:Xe,successDeclineInvitationsAction:Je,failureDeclineInvitationsAction:Ke}=We.actions,Qe=We.reducer,et="client:sent_invitation",tt="client:decline_invitation",rt="server:sent_invitation",nt="server:decline_invitation",ot=function*(){try{const e=yield(0,I.RE)(De);yield(0,I.gz)(Be(e.data.invitations))}catch(e){console.error(e),yield(0,I.gz)(Ne(e))}},at=function*({payload:e}){try{const t=yield(0,I.RE)(qe,e);yield(0,I.gz)(He(t.data.invitations)),Ge.emit(et,e.friend_id)}catch(e){console.error(e),yield(0,I.gz)(Ye(e))}},lt=function*({payload:e}){try{const t=yield(0,I.RE)($e,e);yield(0,I.gz)(Je(t.data.invitations)),Ge.emit(tt,e.friend_id)}catch(e){console.error(e),yield(0,I.gz)(Ke(e))}},it=[function*(){yield(0,I.$6)([(0,I.ib)(B.type,de),(0,I.ib)(H.type,pe),(0,I.ib)($.type,ce),(0,I.ib)(J.type,ue)])},function*(){yield(0,I.$6)([(0,I.ib)(f.type,le),(0,I.ib)(h.type,ie),(0,I.ib)(k.type,se)])},function*(){yield(0,I.$6)([(0,I.ib)(ge.type,Le),(0,I.ib)(ke.type,Pe),(0,I.ib)(ve.type,Fe),(0,I.ib)(be.type,Me)])},function*(){yield(0,I.$6)([(0,I.ib)(Ue.type,ot),(0,I.ib)(Ve.type,at),(0,I.ib)(Xe.type,lt)])}],st=(0,s.oM)({name:"meet",initialState:{meet:{user:null,isInitiator:!1},meetState:"new"},reducers:{setMeetAction:(e,{payload:t})=>{e.meet.user=t.user,e.meet.isInitiator=t.isInitiator},setMeetStateAction:(e,{payload:t})=>{e.meetState=t.meetState}}}),{setMeetAction:ct,setMeetStateAction:dt}=st.actions,pt=st.reducer,ut=(0,c.ZP)(),mt=(0,s.xC)({reducer:{authorization:ee,user:S,friends:_e,invitations:Qe,meet:pt},middleware:[ut]});ut.run((function*(){yield(0,I.$6)(it.map((e=>(0,I.rM)(e))))}));var gt=r(7294),ft=r(6974),xt=r(1797),vt=r(7294),ht=Object.defineProperty,Et=Object.getOwnPropertySymbols,bt=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable,Zt=(e,t,r)=>t in e?ht(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const kt=(0,gt.memo)((e=>{var t=((e,t)=>{var r={};for(var n in e)bt.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Et)for(var n of Et(e))t.indexOf(n)<0&&yt.call(e,n)&&(r[n]=e[n]);return r})(e,[]);return vt.createElement(xt.Z,((e,t)=>{for(var r in t||(t={}))bt.call(t,r)&&Zt(e,r,t[r]);if(Et)for(var r of Et(t))yt.call(t,r)&&Zt(e,r,t[r]);return e})({},t))}));var Ct=r(1508),wt=r(2658),_t=r(270),St=r(6867),It=r(6634),At=r(5697),Tt=r(2186),Gt=r(4345),zt=r(4128);const Ot=(0,Gt.Z)({palette:{primary:{light:zt.Z.A400,main:zt.Z[500],dark:zt.Z[800]}}}),Rt=r.p+"assets/images/authorization-image.6642b50856b9fc50fde3936da1774bf9.jpg";var jt=r(7294);const Lt=(0,gt.memo)((({children:e})=>jt.createElement(Ct.Z,{sx:{display:"grid",alignItems:"center",justifyContent:"center",height:"100%"}},e)));var Pt=r(6236),Ft=r(7294);const Mt=(0,gt.memo)((()=>{const e=(0,o.I0)(),t=(0,ft.s0)(),{loading:r}=(0,o.v9)((e=>e.authorization)),[n,a]=(0,gt.useState)(""),[l,s]=(0,gt.useState)(""),[c,d]=(0,gt.useState)(!1);return Ft.createElement(Lt,null,Ft.createElement(Ct.Z,{sx:{display:"grid",width:"920px",gridTemplateColumns:"448px 472px",borderRadius:"20px",border:`1px solid ${Ot.palette.grey[300]}`,overflow:"hidden"}},Ft.createElement(Ct.Z,null,Ft.createElement("img",{className:i.iv`
              width: 100%;
              height: 100%;
              object-fit: cover;
            `,src:Rt,alt:"Илюстрация."})),Ft.createElement(Ct.Z,{sx:{padding:"48px 56px",backgroundColor:`${Ot.palette.common.white}`}},Ft.createElement(Ct.Z,{sx:{display:"grid",rowGap:"16px"}},Ft.createElement(Ct.Z,{sx:{display:"grid",rowGap:"32px"}},Ft.createElement(Ct.Z,{sx:{display:"grid",rowGap:"32px"}},Ft.createElement(wt.Z,{variant:"h5"},"Войти в свой профиль"),Ft.createElement(Ct.Z,{sx:{display:"grid",rowGap:"24px"}},Ft.createElement(kt,{type:"email",id:"email",name:"email",label:"Адрес электронной почты",value:n,onChange:e=>a(e.target.value),placeholder:"Введите ваш email",autoComplete:"off",fullWidth:!0}),Ft.createElement(kt,{type:c?"text":"password",id:"password",name:"password",label:"Пароль",value:l,onChange:e=>s(e.target.value),placeholder:"Введите ваш пароль",autoComplete:"off",fullWidth:!0,InputProps:{endAdornment:Ft.createElement(_t.Z,{position:"end"},Ft.createElement(St.Z,{onClick:()=>d(!c)},c?Ft.createElement(At.Z,null):Ft.createElement(Tt.Z,null)))}}))),Ft.createElement(Pt.Z,{disableElevation:!0,disableRipple:!0,sx:{pdding:"8px 16px",textTransform:"initial"},variant:"contained",color:"primary",size:"large",loading:r.access_token||r.refresh_token,onClick:()=>{e(B({email:n,password:l}))}},"Войти")),Ft.createElement(wt.Z,{variant:"subtitle2"},"У Вас ещё нет профиля?"," ",Ft.createElement(It.Z,{sx:{cursor:"pointer"},underline:"hover",onClick:e=>{e.preventDefault(),t("/registration")}},"Зарегистрироваться"))))))}));var Dt=r(7294);const qt=(0,gt.memo)((()=>{const e=(0,o.I0)(),t=(0,ft.s0)(),{loading:r}=(0,o.v9)((e=>e.authorization)),[n,a]=(0,gt.useState)(""),[l,s]=(0,gt.useState)(""),[c,d]=(0,gt.useState)(""),[p,u]=(0,gt.useState)(!1);return Dt.createElement(Lt,null,Dt.createElement(Ct.Z,{sx:{display:"grid",width:"920px",gridTemplateColumns:"448px 472px",borderRadius:"20px",border:`1px solid ${Ot.palette.grey[300]}`,overflow:"hidden"}},Dt.createElement(Ct.Z,null,Dt.createElement("img",{className:i.iv`
              width: 100%;
              height: 100%;
              object-fit: cover;
            `,src:Rt,alt:"Илюстрация."})),Dt.createElement(Ct.Z,{sx:{padding:"48px 56px",backgroundColor:`${Ot.palette.common.white}`}},Dt.createElement(Ct.Z,{sx:{display:"grid",rowGap:"16px"}},Dt.createElement(Ct.Z,{sx:{display:"grid",rowGap:"24px"}},Dt.createElement(Ct.Z,{sx:{display:"grid",rowGap:"32px"}},Dt.createElement(wt.Z,{variant:"h5"},"Создать учётную запись"),Dt.createElement(Ct.Z,{sx:{display:"grid",rowGap:"24px"}},Dt.createElement(xt.Z,{type:"email",id:"email",name:"email",label:"Адрес электронной почты",value:n,onChange:e=>a(e.target.value),placeholder:"Введите ваш email",autoComplete:"off",fullWidth:!0}),Dt.createElement(xt.Z,{type:"text",id:"name",name:"name",label:"Имя пользователя",value:l,onChange:e=>s(e.target.value),placeholder:"Введите ваше имя",autoComplete:"off",fullWidth:!0}),Dt.createElement(xt.Z,{type:p?"text":"password",id:"password",name:"password",label:"Пароль",value:c,onChange:e=>d(e.target.value),placeholder:"Введите ваш пароль",autoComplete:"off",fullWidth:!0,InputProps:{endAdornment:Dt.createElement(_t.Z,{position:"end"},Dt.createElement(St.Z,{onClick:()=>u(!p)},p?Dt.createElement(At.Z,null):Dt.createElement(Tt.Z,null)))}}))),Dt.createElement(Ct.Z,{sx:{display:"grid",rowGap:"32px"}},Dt.createElement(wt.Z,{variant:"caption",color:Ot.palette.grey[500]},"Регистрируясь, Вы соглашаетесь с"," ",Dt.createElement(It.Z,{sx:{cursor:"pointer"},underline:"hover"},"политикой обработки персональных данных")),Dt.createElement(Pt.Z,{disableElevation:!0,disableRipple:!0,sx:{pdding:"8px 16px",textTransform:"initial"},variant:"contained",color:"primary",size:"large",loading:r.access_token||r.refresh_token,onClick:()=>e($({email:n,name:l,password:c}))},"Зарегистрироваться"))),Dt.createElement(wt.Z,{variant:"subtitle2"},Dt.createElement(It.Z,{sx:{cursor:"pointer"},underline:"hover",onClick:e=>{e.preventDefault(),t("/authorization")}},"Уже зарегистрированы?"))))))}));var $t=r(7294);const Wt=(0,gt.memo)((()=>$t.createElement(ft.Z5,null,$t.createElement(ft.AW,{path:"authorization",element:$t.createElement(Mt,null)}),$t.createElement(ft.AW,{path:"registration",element:$t.createElement(qt,null)}),$t.createElement(ft.AW,{path:"*",element:$t.createElement(ft.Fg,{to:"authorization"})}))));var Ut=r(6914),Bt=r(7294),Nt=Object.defineProperty,Vt=Object.getOwnPropertySymbols,Ht=Object.prototype.hasOwnProperty,Yt=Object.prototype.propertyIsEnumerable,Xt=(e,t,r)=>t in e?Nt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Jt=(e,t)=>{for(var r in t||(t={}))Ht.call(t,r)&&Xt(e,r,t[r]);if(Vt)for(var r of Vt(t))Yt.call(t,r)&&Xt(e,r,t[r]);return e};const Kt=(0,gt.memo)((e=>{var t=e,{children:r,sx:n}=t,o=((e,t)=>{var r={};for(var n in e)Ht.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Vt)for(var n of Vt(e))t.indexOf(n)<0&&Yt.call(e,n)&&(r[n]=e[n]);return r})(t,["children","sx"]);return Bt.createElement(Ut.Z,Jt({disableElevation:!0,disableRipple:!0,sx:Jt({padding:"8px 16px",textTransform:"initial"},n)},o),r)}));var Qt=r(2855),er=r(4433),tr=r(5683),rr=r(6454),nr=r(7720),or=r(7294);const ar=(0,gt.memo)((()=>{const e=(0,ft.s0)();return or.createElement(Ct.Z,{sx:{display:"grid",rowGap:"24px",height:"100%",alignContent:"start",padding:"25px 16px",justifyContent:"center"}},or.createElement(Ct.Z,{sx:{display:"grid",rowGap:"16px"}},or.createElement(rr.Z,{title:"Друзья",arrow:!0,placement:"right"},or.createElement(Ct.Z,{sx:{display:"grid",padding:"8px",backgroundColor:Ot.palette.grey[400],cursor:"pointer",borderRadius:"8px",justifyContent:"center",width:"40px"},onClick:()=>e("/friends")},or.createElement(Qt.Z,null))),or.createElement(rr.Z,{title:"Каналы",arrow:!0,placement:"right"},or.createElement(Ct.Z,{sx:{display:"grid",padding:"8px",backgroundColor:Ot.palette.grey[400],cursor:"pointer",borderRadius:"8px",justifyContent:"center",width:"40px"},onClick:()=>e("/channels")},or.createElement(er.Z,null)))),or.createElement(nr.Z,null),or.createElement(rr.Z,{title:"Настройки",arrow:!0,placement:"right"},or.createElement(Ct.Z,{sx:{display:"grid",padding:"8px",backgroundColor:Ot.palette.grey[400],cursor:"pointer",borderRadius:"8px",justifyContent:"center",width:"40px"},onClick:()=>e("/settings")},or.createElement(tr.Z,null))))}));var lr=r(9346),ir=r(7109),sr=r(6278),cr=r(9999),dr=r(21),pr=r(3996),ur=r(5338),mr=r(5838),gr=r(3847),fr=r(7294),xr=Object.defineProperty,vr=Object.defineProperties,hr=Object.getOwnPropertyDescriptors,Er=Object.getOwnPropertySymbols,br=Object.prototype.hasOwnProperty,yr=Object.prototype.propertyIsEnumerable,Zr=(e,t,r)=>t in e?xr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,kr=(e,t)=>{for(var r in t||(t={}))br.call(t,r)&&Zr(e,r,t[r]);if(Er)for(var r of Er(t))yr.call(t,r)&&Zr(e,r,t[r]);return e},Cr=(e,t)=>vr(e,hr(t));const wr=(0,gt.memo)((()=>{const e=(0,o.I0)(),{user:t,media:r}=(0,o.v9)((e=>e.user)),{meet:n,meetState:a}=(0,o.v9)((e=>e.meet)),[l,i]=(0,gt.useState)(0);(0,gt.useEffect)((()=>{const e=setInterval((()=>{const e=Date.now();Ge.emit("client:ping",e)}),5e3);return Ge.on("server:ping",(e=>{i(Date.now()-e)})),()=>{clearInterval(e),Ge.removeListener("server:ping")}}),[a]);const s=l<=50?"Хорошее качество связи: "+l+"ms":l<=100?"Нормальное качество связи: "+l+"ms":"Плохое качество связи: "+l+"ms";return fr.createElement(Ct.Z,{sx:{display:"grid",alignItems:"center",backgroundColor:Ot.palette.grey[300],padding:"12px 20px"}},fr.createElement(Ct.Z,{sx:{display:"grid",columnGap:"8px",gridTemplateColumns:"40px 1fr max-content"}},fr.createElement(Ct.Z,{sx:{".MuiBadge-badge":{border:`1px solid ${Ot.palette.common.white}`},".MuiBadge-colorSuccess":{backgroundColor:Ot.palette.success.light},".MuiBadge-colorError":{backgroundColor:Ot.palette.error.light}}},fr.createElement(lr.Z,{overlap:"circular",variant:"dot",anchorOrigin:{vertical:"bottom",horizontal:"right"},color:"online"===(null==t?void 0:t.status)?"success":"error"},fr.createElement(ir.Z,{sx:{backgroundColor:(null==t?void 0:t.color)?t.color:null==t?void 0:t.default_color},src:null==t?void 0:t.image}))),fr.createElement(Ct.Z,null,fr.createElement(wt.Z,{variant:"body2"},null==t?void 0:t.name),fr.createElement(wt.Z,{sx:{color:Ot.palette.grey[500]},variant:"caption"},"#",null==t?void 0:t.id.slice(-4))),"connected"===a&&fr.createElement(Ct.Z,{sx:{display:"grid",columnGap:"16px",gridTemplateColumns:"repeat(3, max-content)",alignItems:"center"}},fr.createElement(Ct.Z,null,fr.createElement(rr.Z,{title:s,arrow:!0},fr.createElement(St.Z,null,l<=50?fr.createElement(sr.Z,{sx:{color:Ot.palette.grey[700]}}):l<=100?fr.createElement(cr.Z,{sx:{color:Ot.palette.grey[700]}}):fr.createElement(dr.Z,{sx:{color:Ot.palette.grey[700]}})))),fr.createElement(St.Z,{onClick:()=>{var o;(null==(o=n.user)?void 0:o.id)&&Ge.emit("client:media_state_change",{media:Cr(kr({},r),{audio:!r.audio}),userFromCall:t,userToCall:n.user}),e(_(Cr(kr({},r),{audio:!r.audio})))}},r.audio?fr.createElement(pr.Z,{sx:{color:Ot.palette.grey[700]}}):fr.createElement(ur.Z,{sx:{color:Ot.palette.grey[700]}})),fr.createElement(St.Z,{onClick:()=>{var o;(null==(o=n.user)?void 0:o.id)&&Ge.emit("client:media_state_change",{media:Cr(kr({},r),{video:!r.video}),userFromCall:t,userToCall:n.user}),e(_(Cr(kr({},r),{video:!r.video})))}},r.video?fr.createElement(mr.Z,{sx:{color:Ot.palette.grey[700]}}):fr.createElement(gr.Z,{sx:{color:Ot.palette.grey[700]}})))))}));var _r=r(7294);const Sr=(0,gt.memo)((()=>{const e=(0,ft.s0)(),{pathname:t}=(0,ft.TH)();return _r.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"72px 376px 1fr",height:"100%",backgroundColor:Ot.palette.common.white}},_r.createElement(Ct.Z,{sx:{backgroundColor:Ot.palette.grey[200]}},_r.createElement(ar,null)),_r.createElement(Ct.Z,{sx:{display:"grid",gridTemplateRows:"72px max-content 1fr 64px",backgroundColor:Ot.palette.grey[400],overflow:"hidden"}},_r.createElement(Ct.Z,{sx:{padding:"24px 20px",borderBottom:`1px solid ${Ot.palette.grey[600]}`}},_r.createElement(wt.Z,{variant:"h6"},"Личные сообщения")),_r.createElement(Ct.Z,{sx:{padding:"16px"}},_r.createElement(Kt,{fullWidth:!0,variant:"contained",onClick:()=>e("/friends")},"Друзья")),_r.createElement(Ct.Z,{sx:{margin:"28px 4px",overflowY:"scroll","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{backgroundColor:"none"},"&::-webkit-scrollbar-thumb":{backgroundColor:Ot.palette.grey[300],border:`1px solid ${Ot.palette.grey[500]}`,borderRadius:"8px"}}},_r.createElement(Ct.Z,{sx:{display:"grid",rowGap:"12px",padding:"0 4px"}})),_r.createElement(wr,null)),_r.createElement(Ct.Z,{sx:{display:"grid",gridTemplateRows:"72px 1fr",backgroundColor:Ot.palette.grey[500],overflow:"hidden"}},_r.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",columnGap:"24px",padding:"16px 24px",borderBottom:`1px solid ${Ot.palette.grey[400]}`,alignItems:"center"}},_r.createElement(wt.Z,{variant:"h6"},"Друзья"),_r.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(5, max-content)",columnGap:"8px"}},_r.createElement(Kt,{variant:t.includes("online")?"contained":"outlined",color:"primary",onClick:()=>e("online")},"В сети"),_r.createElement(Kt,{variant:t.includes("all")?"contained":"outlined",color:"primary",onClick:()=>e("all")},"Все"),_r.createElement(Kt,{variant:t.includes("invitations")?"contained":"outlined",color:"primary",onClick:()=>e("invitations")},"Ожидание"),_r.createElement(Kt,{variant:t.includes("blocked")?"contained":"outlined",color:"primary",onClick:()=>e("blocked")},"Заблокированные"),_r.createElement(Kt,{variant:t.includes("add")?"contained":"outlined",color:"success",onClick:()=>e("add")},"Добавить в друзья"))),_r.createElement(ft.j3,null)))}));var Ir=r(7294);const Ar=(0,gt.memo)((()=>{const e=(0,ft.s0)(),t=(0,ft.TH)(),r=(0,o.I0)(),{user:n}=(0,o.v9)((e=>e.user)),a=[{id:1,title:"Моя учётная запись",path:"user-account",onClick:()=>{e("user-account")},divider:!1},{id:2,title:"Профиль пользователя",path:"user-profile",onClick:()=>{e("user-profile")},divider:!1},{id:3,title:"Голос и видео",path:"voice-and-video",onClick:()=>{e("voice-and-video")},divider:!1},{id:4,title:"Выйти",path:"logout",onClick:()=>{r(J()),(null==n?void 0:n.id)&&Ge.emit(O,n.id)},divider:!0}];return Ir.createElement(Ct.Z,{sx:{padding:"60px 8px",backgroundColor:"#43454a"}},Ir.createElement(wt.Z,{className:i.iv`
          padding: 6px 10px !important;
          font-weight: 700 !important;
          font-size: 12px !important;
          line-height: 16px !important;
          color: #a0a2a6;
          text-transform: uppercase;
        `},"Настройки пользователя"),Ir.createElement(Ct.Z,{component:"ul",className:i.iv`
          display: grid;
          margin: 0;
          padding: 0;
          list-style: none;
          row-gap: 2px;
        `},a.map((e=>Ir.createElement(Ir.Fragment,null,e.divider&&Ir.createElement(nr.Z,{sx:{borderColor:"rgba(255, 255, 255, 0.25)",margin:"8px 10px"}}),Ir.createElement(Ct.Z,{key:e.id,component:"li",className:i.iv`
                  padding: 6px 10px !important;
                  font-weight: 500 !important;
                  font-size: 16px !important;
                  line-height: 20px !important;
                  background-color: ${t.pathname.includes(e.path)?"#60656c":"none"};
                  border-radius: 4px;
                  cursor: pointer;

                  &:hover,
                  &:focus {
                    background-color: ${t.pathname.includes(e.path)?"#565a61":"#87888d"};

                    p {
                      color: #dfe0e1;
                    }
                  }
                `,onClick:e.onClick},Ir.createElement(It.Z,{underline:"none"},Ir.createElement(wt.Z,{sx:{color:t.pathname.includes(e.path)?"#ffffff":"#a0a2a6"}},e.title))))))),Ir.createElement(wt.Z,{className:i.iv`
          padding: 6px 10px !important;
          font-weight: 700 !important;
          font-size: 12px !important;
          line-height: 16px !important;
          color: #a0a2a6;
          text-transform: uppercase;
        `},"Настройки приложения"))}));var Tr=r(7294);const Gr=(0,gt.memo)((()=>{const e=(0,ft.s0)();return(0,gt.useEffect)((()=>{e("user-account")}),[]),Tr.createElement(Ct.Z,{sx:{display:"grid",width:"100%",height:"100%",backgroundColor:Ot.palette.grey[500]}},Tr.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"224px 740px",height:"100%",justifyContent:"center",backgroundImage:"linear-gradient(to right, #43454a 50%, #5e6065 50%)"}},Tr.createElement(Ar,null),Tr.createElement(ft.j3,null)))}));var zr=r(7294);const Or=(0,gt.memo)((()=>zr.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"72px 376px 1fr",height:"100%",backgroundColor:Ot.palette.common.white}},zr.createElement(Ct.Z,{sx:{backgroundColor:Ot.palette.grey[200]}},zr.createElement(ar,null)),zr.createElement(Ct.Z,{sx:{display:"grid",gridTemplateRows:"72px 1fr 64px",backgroundColor:Ot.palette.grey[400],overflow:"hidden"}},zr.createElement(Ct.Z,{sx:{padding:"24px 20px",borderBottom:`1px solid ${Ot.palette.grey[600]}`}},zr.createElement(wt.Z,{variant:"h6"},"Каналы")),zr.createElement(Ct.Z,{sx:{padding:"0 8px",margin:"28px 0",overflow:"scroll"}},zr.createElement(Ct.Z,{sx:{display:"grid",rowGap:"12px"}},Array.from(Array(25).keys()).map((e=>zr.createElement(Ct.Z,{key:e}))))),zr.createElement(wr,null)),zr.createElement(Ct.Z,{sx:{backgroundColor:Ot.palette.grey[600]}}))));var Rr=r(7294);const jr=(0,gt.memo)((()=>Rr.createElement(Or,null)));var Lr=r(4125),Pr=r(1753),Fr=r(720),Mr=r(8416),Dr=r(6046),qr=r(7003),$r=r(7294);const Wr=(0,gt.memo)((({user:e})=>{const t=(0,o.I0)(),r=(0,ft.s0)(),[n,a]=(0,gt.useState)(null);return $r.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content 1fr",alignItems:"center"}},$r.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content 1fr",columnGap:"8px",alignItems:"center",padding:"8px 12px",borderRadius:"8px",cursor:"pointer",".MuiBadge-badge":{border:`1px solid ${Ot.palette.common.white}`},".MuiBadge-colorSuccess":{backgroundColor:Ot.palette.success.light},".MuiBadge-colorError":{backgroundColor:Ot.palette.error.light}}},$r.createElement(lr.Z,{overlap:"circular",variant:"dot",anchorOrigin:{vertical:"bottom",horizontal:"right"},color:(null==e?void 0:e.status)&&"online"===e.status?"success":"error"},$r.createElement(ir.Z,{sx:{backgroundColor:Fr.Z[500]},src:(null==e?void 0:e.image)?e.image:""})),$r.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content"}},$r.createElement(wt.Z,{variant:"body2"},(null==e?void 0:e.name)?e.name:""),$r.createElement(wt.Z,{variant:"caption"},(null==e?void 0:e.status)&&"online"===e.status?"В сети":"Не в сети"))),$r.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(3, 24px)",columnGap:"24px",alignItems:"center",justifyContent:"end"}},$r.createElement(St.Z,{sx:{width:"32px",height:"32px"},onClick:()=>{console.log("LOGS: Chat button pressed")}},$r.createElement(Mr.Z,null)),$r.createElement(St.Z,{sx:{width:"32px",height:"32px"},onClick:()=>{t(ct({user:e,isInitiator:!0})),r("/meet"),console.log("LOGS: Кнопка позвонить нажата.")}},$r.createElement(Dr.Z,null)),$r.createElement(St.Z,{sx:{width:"32px",height:"32px"},onClick:e=>{a(e.currentTarget),console.log("LOGS: Кнопка еще нажата.")}},$r.createElement(qr.Z,null))),$r.createElement(Lr.Z,{anchorEl:n,open:Boolean(n),onClose:()=>{a(null)}},$r.createElement(Pr.Z,{onClick:()=>{a(null)}},"Написать"),$r.createElement(Pr.Z,{onClick:()=>{t(ct({user:e,isInitiator:!0})),r("/meet"),a(null),console.log("LOGS: Кнопка позвонить нажата.")}},"Позвонить"),$r.createElement(Pr.Z,{onClick:()=>{t(be({friend_id:e.id})),a(null)}},"Удалить из друзей")))}));var Ur=r(7294);const Br=(0,gt.memo)((()=>{const e=(0,o.I0)(),{friends:t}=(0,o.v9)((e=>e.friends));return(0,gt.useEffect)((()=>{e(ge()),Ge.on(R,(()=>{e(ge())})),Ge.on(j,(()=>{e(ge())})),Ge.on(Re,(()=>{e(ge())})),Ge.on(je,(()=>{e(ge())}))}),[]),Ur.createElement(Ct.Z,{sx:{padding:"0 8px 0 16px",margin:"16px 8px 16px 0",display:"grid",alignContent:"start",rowGap:"8px",overflowY:"scroll","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{backgroundColor:"none"},"&::-webkit-scrollbar-thumb":{backgroundColor:Ot.palette.grey[300],border:`1px solid ${Ot.palette.grey[500]}`,borderRadius:"8px"}}},Ur.createElement(Ct.Z,{sx:{padding:"8px 12px"}},Ur.createElement(wt.Z,{variant:"h6"},"Всего друзей: ",t&&(null==t?void 0:t.length)>0?null==t?void 0:t.length:0)),Ur.createElement(Ct.Z,{sx:{display:"grid",alignContent:"start",rowGap:"8px"}},t.map((e=>Ur.createElement(Wr,{key:e.id,user:e})))))}));var Nr=r(7294);const Vr=(0,gt.memo)((()=>{const e=(0,o.I0)(),{friends:t}=(0,o.v9)((e=>e.friends));return(0,gt.useEffect)((()=>{e(ge()),Ge.on(R,(()=>{e(ge())})),Ge.on(j,(()=>{e(ge())})),Ge.on(Re,(()=>{e(ge())})),Ge.on(je,(()=>{e(ge())}))}),[]),Nr.createElement(Ct.Z,{sx:{padding:"0 8px 0 16px",margin:"16px 8px 16px 0",display:"grid",alignContent:"start",rowGap:"8px",overflowY:"scroll","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{backgroundColor:"none"},"&::-webkit-scrollbar-thumb":{backgroundColor:Ot.palette.grey[300],border:`1px solid ${Ot.palette.grey[500]}`,borderRadius:"8px"}}},Nr.createElement(Ct.Z,{sx:{padding:"8px 12px"}},Nr.createElement(wt.Z,{variant:"h6"},"В сети: ",t&&t.length>0?t.filter((e=>"online"===e.status)).length:0)),Nr.createElement(Ct.Z,{sx:{display:"grid",alignContent:"start",rowGap:"8px"}},t.map((e=>"online"===e.status?Nr.createElement(Wr,{key:e.id,user:e}):null))))}));var Hr=r(7294);const Yr=(0,gt.memo)((({id:e,name:t,status:r,image:n})=>{const a=(0,o.I0)();return Hr.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content 1fr",alignItems:"center"}},Hr.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content 1fr",columnGap:"8px",alignItems:"center",padding:"8px 12px",borderRadius:"8px",cursor:"pointer",".MuiBadge-badge":{border:`1px solid ${Ot.palette.common.white}`},".MuiBadge-colorSuccess":{backgroundColor:Ot.palette.success.light},".MuiBadge-colorError":{backgroundColor:Ot.palette.error.light}}},Hr.createElement(lr.Z,{overlap:"circular",variant:"dot",anchorOrigin:{vertical:"bottom",horizontal:"right"},color:"online"===r?"success":"error"},Hr.createElement(ir.Z,{sx:{backgroundColor:Fr.Z[500]},src:n})),Hr.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content"}},Hr.createElement(wt.Z,{variant:"body2"},t||""),Hr.createElement(wt.Z,{variant:"caption"},"online"===r?"В сети":"Не в сети"))),Hr.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",columnGap:"24px",alignItems:"center",justifyContent:"end"}},Hr.createElement(Kt,{variant:"contained",color:"primary",onClick:()=>{a(ve({friend_id:e}))}},"Добавить"),Hr.createElement(Kt,{variant:"contained",color:"primary",onClick:()=>{a(Xe({friend_id:e}))}},"Отклонить")))}));var Xr=r(7294);const Jr=(0,gt.memo)((()=>{const e=(0,o.I0)(),{invitations:t}=(0,o.v9)((e=>e.invitations));return(0,gt.useEffect)((()=>{e(Ue()),Ge.on(R,(()=>{e(Ue())})),Ge.on(j,(()=>{e(Ue())})),Ge.on(rt,(()=>{e(Ue())})),Ge.on(nt,(()=>{e(Ue())})),Ge.on(Re,(()=>{e(Ue())}))}),[]),Xr.createElement(Ct.Z,{sx:{padding:"0 8px 0 16px",margin:"16px 8px 16px 0",display:"grid",alignContent:"start",rowGap:"8px",overflowY:"scroll","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{backgroundColor:"none"},"&::-webkit-scrollbar-thumb":{backgroundColor:Ot.palette.grey[300],border:`1px solid ${Ot.palette.grey[500]}`,borderRadius:"8px"}}},Xr.createElement(Ct.Z,{sx:{padding:"8px 12px"}},Xr.createElement(wt.Z,{variant:"h6"},"Ожидают добавления в друзья:"," ",t.received&&t.received.length>0?t.received.length:0)),Xr.createElement(Ct.Z,{sx:{display:"grid",alignContent:"start",rowGap:"8px"}},t.received.map((e=>Xr.createElement(Yr,{key:e.id,id:e.id,name:e.name,status:e.status,image:e.image})))))})),Kr=e=>e.user.user,Qr=e=>e.user.approvals;var en=r(7294);const tn=(0,gt.memo)((({id:e,name:t,status:r})=>en.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content 1fr",alignItems:"center"}},en.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content 1fr",columnGap:"8px",alignItems:"center",padding:"8px 12px",borderRadius:"8px",cursor:"pointer",".MuiBadge-badge":{border:`1px solid ${Ot.palette.common.white}`},".MuiBadge-colorSuccess":{backgroundColor:Ot.palette.success.light},".MuiBadge-colorError":{backgroundColor:Ot.palette.error.light}}},en.createElement(lr.Z,{overlap:"circular",variant:"dot",anchorOrigin:{vertical:"bottom",horizontal:"right"},color:"online"===r?"success":"error"},en.createElement(ir.Z,{sx:{backgroundColor:Fr.Z[500]}})),en.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content"}},en.createElement(wt.Z,{variant:"body2"},t||""),en.createElement(wt.Z,{variant:"caption"},"online"===r?"В сети":"Не в сети"))),en.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",columnGap:"24px",alignItems:"center",justifyContent:"end"}},en.createElement(wt.Z,{variant:"body1"},"Ожидает добавления в друзья"),en.createElement(Kt,{variant:"contained",color:"primary",onClick:()=>{return void 0,null,t=function*(){const t=yield te.post("/remove-invite-to-friends",{friendId:e});return Ge.emit("on-remove-invite-to-friends",e),t.data},new Promise(((e,r)=>{var n=e=>{try{a(t.next(e))}catch(e){r(e)}},o=e=>{try{a(t.throw(e))}catch(e){r(e)}},a=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,o);a((t=t.apply(undefined,null)).next())}));var t}},"Отклонить")))));var rn=r(7294);const nn=(0,gt.memo)((()=>{const e=(0,o.v9)(Qr);return rn.createElement(Ct.Z,{sx:{padding:"0 8px 0 16px",margin:"16px 8px 16px 0",display:"grid",alignContent:"start",rowGap:"8px",overflowY:"scroll","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{backgroundColor:"none"},"&::-webkit-scrollbar-thumb":{backgroundColor:Ot.palette.grey[300],border:`1px solid ${Ot.palette.grey[500]}`,borderRadius:"8px"}}},e.map((e=>rn.createElement(tn,{key:e.id,id:e.id,name:e.name,status:e.status}))))}));var on=r(7294);const an=(0,gt.memo)((({id:e,name:t,status:r,image:n,sentInvitation:a,addToFriends:l,receivedInvitation:i,setSearchValue:s})=>{const c=(0,o.I0)(),{user:d}=(0,o.v9)((e=>e.user));return on.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content 1fr",alignItems:"center"}},on.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content 1fr",columnGap:"8px",alignItems:"center",padding:"8px 12px",borderRadius:"8px",cursor:"pointer",".MuiBadge-badge":{border:`1px solid ${Ot.palette.common.white}`},".MuiBadge-colorSuccess":{backgroundColor:Ot.palette.success.light},".MuiBadge-colorError":{backgroundColor:Ot.palette.error.light}}},on.createElement(lr.Z,{overlap:"circular",variant:"dot",anchorOrigin:{vertical:"bottom",horizontal:"right"},color:"online"===r?"success":"error"},on.createElement(ir.Z,{sx:{backgroundColor:Fr.Z[500]},src:n})),on.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content"}},on.createElement(wt.Z,{variant:"body2"},t||""),on.createElement(wt.Z,{variant:"caption"},"online"===r?"В сети":"Не в сети"))),on.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(1, max-content)",columnGap:"24px",alignItems:"center",justifyContent:"end"}},!l&&!a&&!i&&on.createElement(Kt,{variant:"contained",color:"primary",onClick:()=>{c(Ve({friend_id:e}))}},"Добавить в друзья"),l&&on.createElement(Kt,{variant:"outlined",color:"error",onClick:()=>{c(be({friend_id:e}))}},"Удалить из друзей"),a&&on.createElement(Kt,{variant:"outlined",color:"error",onClick:()=>{c(Xe({friend_id:e}))}},"Отклонить приглашение"),i&&on.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",alignItems:"center",columnGap:"8px"}},on.createElement(Kt,{variant:"outlined",color:"success",onClick:()=>{c(ve({friend_id:e}))}},"Принять приглашение"),on.createElement(Kt,{variant:"outlined",color:"error",onClick:()=>{c(Xe({friend_id:e}))}},"Отклонить приглашение"))))}));var ln=r(7294);const sn=(0,gt.memo)((()=>{const e=(0,o.I0)(),{friends_users:t}=(0,o.v9)((e=>e.friends)),[r,n]=(0,gt.useState)("");return(0,gt.useEffect)((()=>{}),[r]),(0,gt.useEffect)((()=>{e(ke()),Ge.on(R,(()=>{e(ke())})),Ge.on(j,(()=>{e(ke())})),Ge.on(Re,(()=>{e(ke())})),Ge.on(je,(()=>{e(ke())})),Ge.on(nt,(()=>{e(ke())})),Ge.on(rt,(()=>{e(ke())}))}),[]),ln.createElement(Ct.Z,{sx:{padding:"0 8px 0 16px",margin:"16px 8px 16px 0"}},ln.createElement(kt,{fullWidth:!0,size:"small",placeholder:"Поиск по друзьям",value:r,onChange:e=>n(e.target.value)}),ln.createElement(Ct.Z,{sx:{padding:"0 8px 0 16px",margin:"16px 8px 16px 0",display:"grid",alignContent:"start",rowGap:"8px",overflowY:"scroll","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{backgroundColor:"none"},"&::-webkit-scrollbar-thumb":{backgroundColor:Ot.palette.grey[300],border:`1px solid ${Ot.palette.grey[500]}`,borderRadius:"8px"}}},t.map((e=>ln.createElement(an,{key:e.id,id:e.id,name:e.name,status:e.status,image:e.image,sentInvitation:e.sent_invitation,addToFriends:e.add_to_friends,receivedInvitation:e.received_invitation,setSearchValue:n})))))}));var cn=r(3816),dn=r(2026),pn=r(5196),un=r(4399),mn=r(3546),gn=r(9986),fn=r(4776),xn=(e,t,r)=>new Promise(((n,o)=>{var a=e=>{try{i(r.next(e))}catch(e){o(e)}},l=e=>{try{i(r.throw(e))}catch(e){o(e)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,l);i((r=r.apply(e,t)).next())})),vn=r(2132),hn=r(7294);const En=(0,gt.memo)((()=>{const e=(0,ft.s0)(),t=(0,o.I0)(),r=(0,o.v9)(Kr),[n,a]=(0,gt.useState)(""),[l,s]=(0,gt.useState)(null==r?void 0:r.image),[c,d]=(0,gt.useState)(null==r?void 0:r.description),[p,u]=(0,gt.useState)(!0),[m,g]=(0,gt.useState)(!1),{minutes:f,seconds:x}=(()=>{const[e,t]=(0,gt.useState)(0);return(0,gt.useEffect)((()=>{const e=setInterval((()=>{t((e=>e+1))}),1e3);return()=>clearInterval(e)}),[]),{minutes:Math.floor(e/60).toString().padStart(2,"0"),seconds:Number(e-60*Math.floor(e/60)).toString().padStart(2,"0")}})(),v=(0,gt.useRef)(null);return(0,gt.useEffect)((()=>{(null==r?void 0:r.description)&&d(r.description),(null==r?void 0:r.image)&&s(r.image)}),[null==r?void 0:r.description,null==r?void 0:r.image]),(0,gt.useEffect)((()=>{const t=t=>{"Escape"===t.key&&e("friends")};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)}),[]),(0,gt.useEffect)((()=>{""!==n||l!==(null==r?void 0:r.image)||c!==(null==r?void 0:r.description)?g(!0):g(!1)}),[n,l,c]),hn.createElement(Ct.Z,{sx:{position:"relative",display:"grid",padding:"60px 40px 80px 40px",alignContent:"start",backgroundColor:"#5e6065"}},hn.createElement(kt,{sx:{display:"none"},type:"file",id:"image",name:"image",label:"Изображение профиля",inputProps:{ref:e=>v.current=e},onChange:e=>{const t=e.target.files?e.target.files[0]:null,r=new FileReader;t&&(r.readAsDataURL(t),r.onload=()=>{t.size>5242880&&vn.Am.error("Изображение должно быть не более 5MB."),s(String(r.result))}),s(e.target.value)},placeholder:"Выберите изображение профиля",autoComplete:"off",fullWidth:!0,focused:!0}),hn.createElement(gn.Z,{key:fn.Z.name,message:"Аккуратнее, вы не сохранили изменения!",TransitionComponent:fn.Z,open:m,sx:{"&":{position:"absolute",left:"40px",transform:"none",width:"100%",".MuiSnackbarContent-root":{width:"100%"}}},onClose:(e,t)=>{"clickaway"!==t&&g(!1)},anchorOrigin:{vertical:"bottom",horizontal:"center"},action:hn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",columnGap:"16px",alignItems:"center"}},hn.createElement(It.Z,{sx:{cursor:"pointer"},underline:"hover",onClick:()=>{a(""),s(null==r?void 0:r.image),d(null==r?void 0:r.description)}},hn.createElement(wt.Z,null,"Сброс")),hn.createElement(Pt.Z,{sx:{textTransform:"initial"},variant:"contained",color:"success",onClick:()=>{t(h({color:n||void 0,image:l!==(null==r?void 0:r.image)?l:void 0,description:c!==(null==r?void 0:r.description)?c:void 0})),a(""),s(null==r?void 0:r.image),d(null==r?void 0:r.description)}},"Сохранить изменения"))}),hn.createElement(wt.Z,{className:i.iv`
          padding-bottom: 20px !important;
          font-weight: 600 !important;
          font-size: 20px !important;
          line-height: 24px !important;
          color: #ffffff !important;
          border-bottom: 1px solid #000000;
        `},"Профиль пользователя"),hn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"8px",position:"absolute",top:"60px",right:"-40px",textAlign:"center",cursor:"pointer","&:hover svg, &:focus svg":{fill:"#ffffff"}},onClick:()=>e("/friends")},hn.createElement(cn.Z,{sx:{width:"36px",height:"36px",fill:"#b9bbbe"}}),hn.createElement(wt.Z,{sx:{fontSize:"13px",color:"#b9bbbe"}},"ESC")),hn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"340px 300px",columnGap:"20px",justifyContent:"space-between"}},hn.createElement(Ct.Z,null,hn.createElement(Ct.Z,{sx:{padding:"20px 0",borderBottom:"1px solid #000000"}},hn.createElement(wt.Z,{className:i.iv`
                margin-bottom: 8px !important;
                font-weight: 600 !important;
                font-size: 12px !important;
                line-height: 16px !important;
                text-transform: uppercase !important;
              `},"Аватар"),hn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",alignItems:"center",columnGap:"16px"}},hn.createElement(Kt,{sx:{textTransform:"initial"},variant:"contained",onClick:()=>{v.current&&v.current.click()}},"Смена аватара"),(null==r?void 0:r.image)&&hn.createElement(It.Z,{sx:{cursor:"pointer",color:"#ffffff",fontFamily:"sans-serif"},underline:"hover",onClick:()=>s("")},"Удалить аватар"))),hn.createElement(Ct.Z,{sx:{padding:"20px 0",borderBottom:"1px solid #000000"}},hn.createElement(wt.Z,{className:i.iv`
                margin-bottom: 8px !important;
                font-weight: 600 !important;
                font-size: 12px !important;
                line-height: 16px !important;
                text-transform: uppercase !important;
              `},"Цвет профиля"),hn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content max-content",columnGap:"16px"}},hn.createElement(Ct.Z,null,hn.createElement(Ct.Z,{sx:{display:"grid",alignItems:"center",justifyContent:"center",backgroundColor:(null==r?void 0:r.color)?r.color:null==r?void 0:r.default_color,width:"70px",height:"50px",borderRadius:"4px",cursor:"pointer"},onClick:()=>u(!0)},p&&hn.createElement(dn.Z,{sx:{fill:"#ffffff"},width:24,height:24})),hn.createElement(wt.Z,{className:i.iv`
                    font-size: 12px !important;
                    line-height: 16px !important;
                  `},"По умолчанию")),hn.createElement(Ct.Z,{sx:{position:"relative"}},hn.createElement(Ct.Z,{sx:{position:"relative",display:"grid",alignItems:"center",justifyContent:"center",backgroundColor:n,width:"70px",height:"50px",borderRadius:"4px",cursor:"pointer",border:n?"":"1px solid #000000"},onClick:()=>{a("#000000"),u(!1)}},!p&&hn.createElement(dn.Z,{sx:{fill:"#ffffff"},width:24,height:24}),hn.createElement("input",{className:i.iv`
                      position: absolute;
                      top: 0;
                      left: 0;
                      width: 100%;
                      height: 100%;
                      cursor: pointer;
                      opacity: 0;
                    `,type:"color",value:n,onChange:e=>{a(e.target.value),u(!1)}})),hn.createElement(pn.Z,{sx:{position:"absolute",top:"0",right:"8px"},width:14,height:14}),hn.createElement(wt.Z,{className:i.iv`
                    font-size: 12px !important;
                    line-height: 16px !important;
                  `},"Пользовательские"))),hn.createElement(Ct.Z,{sx:{paddingTop:"20px"}},hn.createElement(wt.Z,{className:i.iv`
                  margin-bottom: 8px !important;
                  font-weight: 600 !important;
                  font-size: 12px !important;
                  line-height: 16px !important;
                  text-transform: uppercase !important;
                `},"Баннер профиля"),hn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"16px",justifyItems:"start"}},hn.createElement(wt.Z,null,"Мы рекомендуем использовать изображение как минимум 600x240. Доступные форматы PNG, JPG или анимированные GIF размером не более 5МБ."),hn.createElement(Kt,{sx:{textTransform:"initial"},disableRipple:!0,disableElevation:!0,variant:"contained",color:"success",onClick:()=>null},"Загрузить баннер")))),hn.createElement(Ct.Z,{sx:{padding:"20px 0"}},hn.createElement(wt.Z,{className:i.iv`
                margin-bottom: 8px !important;
                font-weight: 600 !important;
                font-size: 12px !important;
                line-height: 16px !important;
                text-transform: uppercase !important;
              `},"Обо мне"),hn.createElement(wt.Z,{className:i.iv`
                margin-bottom: 8px !important;
                font-size: 14px !important;
                line-height: 20px !important;
              `},"Можно использовать разметку теста и ссылки."),hn.createElement(kt,{value:c,onChange:e=>d(e.target.value),multiline:!0,rows:4,fullWidth:!0}))),hn.createElement(Ct.Z,null,hn.createElement(Ct.Z,{sx:{padding:"20px 0 0 0"}},hn.createElement(wt.Z,{className:i.iv`
                margin-bottom: 8px !important;
                font-weight: 600 !important;
                font-size: 12px !important;
                line-height: 16px !important;
                text-transform: uppercase !important;
              `},"Предпросмотр")),hn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateRows:"60px 1fr",width:"300px",maxHeight:"429px",boxShadow:"0 8px 16px rgba(0,0,0,0.25)",borderRadius:"8px",overflow:"hidden"}},hn.createElement(Ct.Z,{sx:{position:"relative",height:"60px",backgroundColor:(null==r?void 0:r.color)?r.color:null==r?void 0:r.default_color}},hn.createElement(Ct.Z,{sx:{position:"absolute",top:"16px",left:"16px",width:"92px",height:"92px",backgroundImage:l?`url(${l})`:`url(${null==r?void 0:r.image})`,backgroundColor:(null==r?void 0:r.color)?r.color:null==r?void 0:r.default_color,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%",border:`6px solid ${Ot.palette.grey[900]}`,borderRadius:"50%",cursor:"pointer","&:hover, &:focus":{"&::before":{content:'""',display:"block",width:"100%",height:"100%",backdropFilter:"brightness(0.75)",borderRadius:"50%",overflow:"hidden"},"&::after":{content:'"Изменить аватар"',display:"block",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",color:"white",fontFamily:"sans-serif",textTransform:"uppercase",fontSize:"10px"}}},onClick:()=>{v.current&&v.current.click()}},hn.createElement(Ct.Z,{sx:{width:"28px",height:"28px",backgroundColor:Ot.palette.grey[300],position:"absolute",top:"0",right:"0",borderRadius:"50%"}},hn.createElement(un.Z,{sx:{width:"18px",height:"18px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}})))),hn.createElement(Ct.Z,{sx:{padding:"48px 16px 16px 16px",backgroundColor:Ot.palette.grey[900]}},hn.createElement(wt.Z,{className:i.iv`
                  padding: 16px 0;
                  color: #ffffff;
                `},null==r?void 0:r.name,hn.createElement(wt.Z,{className:i.iv`
                    font-size: 20px;
                    line-height: 24px;
                    color: #b9bbbe;
                    text-transform: uppercase;
                  `,component:"span"},"#",null==r?void 0:r.id.slice(-4))),hn.createElement(wt.Z,{className:i.iv`
                  margin-bottom: 8px !important;
                  padding: 20px 0 0 0 !important;
                  font-weight: 600 !important;
                  font-size: 12px !important;
                  line-height: 16px !important;
                  color: #b9bbbe;
                  text-transform: uppercase !important;
                  border-top: 1px solid ${Ot.palette.grey[800]};
                `,variant:"subtitle1"},"Обо мне"),hn.createElement(wt.Z,{sx:{maxHeight:"108px",paddingBottom:"20px"},color:"lightgray"},c),hn.createElement(wt.Z,{className:i.iv`
                  margin-bottom: 8px !important;
                  padding: 20px 0 0 0 !important;
                  font-weight: 600 !important;
                  font-size: 12px !important;
                  line-height: 16px !important;
                  color: #b9bbbe;
                  text-transform: uppercase !important;
                  border-top: 1px solid ${Ot.palette.grey[800]};
                `,variant:"subtitle1"},"Настройка профиля"),hn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"64px 1fr",columnGap:"16px",alignItems:"center"}},hn.createElement(Ct.Z,{sx:{width:"64px",height:"64px",backgroundColor:Ot.palette.primary.light,borderRadius:"8px",display:"grid",alignItems:"center",justifyContent:"center"}},hn.createElement(mn.Z,{sx:{fill:"#ffffff"},width:24,height:24})),hn.createElement(Ct.Z,null,hn.createElement(wt.Z,{variant:"subtitle1",color:"lightgray"},"Профиль пользователя"),hn.createElement(wt.Z,{color:"lightgray"},"Прошло ",f,":",x))))))))}));var bn=r(5537),yn=r(5729),Zn=r(7294);const kn=(0,gt.memo)((({isOpen:e,onClose:t})=>{const r=(0,o.I0)(),[n,a]=(0,gt.useState)(""),[l,i]=(0,gt.useState)("");return Zn.createElement(yn.Z,{open:e,onBackdropClick:t,disableEnforceFocus:!0},Zn.createElement(Ct.Z,{sx:{width:"440px",backgroundColor:"#4a4c52",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:"5px",overflow:"hidden"}},Zn.createElement(Ct.Z,{sx:{position:"relative",display:"grid",rowGap:"8px",padding:"24px 16px"}},Zn.createElement(wt.Z,{sx:{fontSize:"24px",color:"#ffffff",textAlign:"center"}},"Введите адрес электронной почты"),Zn.createElement(wt.Z,{sx:{fontSize:"16px",color:"#c0c1c4",textAlign:"center"}},"Введите новый адрес электронной почты и текущий пароль."),Zn.createElement(Ct.Z,{sx:{position:"absolute",top:"16px",right:"16px",cursor:"pointer","& svg":{fill:"#c0c1c4"},"& svg:hover, & svg:focus":{fill:"#ffffff"}},onClick:t},Zn.createElement(bn.Z,null))),Zn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"16px",padding:"0 16px 24px 16px"}},Zn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"8px"}},Zn.createElement(wt.Z,{sx:{fontSize:"14px",color:"#c0c1c4",textTransform:"uppercase"}},"Электронная почта"),Zn.createElement(kt,{sx:{backgroundColor:"#36383a",".MuiOutlinedInput-input":{color:"#dfe0e1"},"input:-webkit-autofill":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:hover":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:focus":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:active":{boxShadow:"0 0 0 30px #36383a inset"}},type:"email",id:"email",name:"email",value:n,onChange:e=>a(e.target.value),autoComplete:"off",fullWidth:!0})),Zn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"8px"}},Zn.createElement(wt.Z,{sx:{fontSize:"14px",color:"#c0c1c4",textTransform:"uppercase"}},"Текущий пароль"),Zn.createElement(kt,{sx:{backgroundColor:"#36383a",".MuiOutlinedInput-input":{color:"#dfe0e1"},"input:-webkit-autofill":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:hover":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:focus":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:active":{boxShadow:"0 0 0 30px #36383a inset"}},type:"password",id:"password",name:"password",value:l,onChange:e=>i(e.target.value),autoComplete:"off",fullWidth:!0}))),Zn.createElement(Ct.Z,{sx:{display:"grid",justifyContent:"end",gridTemplateColumns:"repeat(2, max-content)",columnGap:"8px",padding:"16px",backgroundColor:"#43454a"}},Zn.createElement(It.Z,{sx:{display:"grid",alignItems:"center",color:"#ffffff",cursor:"pointer",padding:"2px 16px"},underline:"hover",onClick:()=>{a(""),i(""),t()}},Zn.createElement(wt.Z,{sx:{fontSize:"14px"}},"Отмена")),Zn.createElement(Kt,{sx:{textTransform:"initial"},variant:"contained",onClick:()=>{n.trim()&&l.trim()&&(r(h({email:n,password:l})),t())}},"Готово"))))}));var Cn=r(7294);const wn=(0,gt.memo)((({isOpen:e,onClose:t})=>{const r=(0,o.I0)(),{user:n}=(0,o.v9)((e=>e.user)),[a,l]=(0,gt.useState)(null==n?void 0:n.name),[i,s]=(0,gt.useState)("");return Cn.createElement(yn.Z,{open:e,onBackdropClick:t,disableEnforceFocus:!0},Cn.createElement(Ct.Z,{sx:{width:"440px",backgroundColor:"#4a4c52",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:"5px",overflow:"hidden"}},Cn.createElement(Ct.Z,{sx:{position:"relative",display:"grid",rowGap:"8px",padding:"24px 16px"}},Cn.createElement(wt.Z,{sx:{fontSize:"24px",color:"#ffffff",textAlign:"center"}},"Изменить имя пользователя"),Cn.createElement(wt.Z,{sx:{fontSize:"16px",color:"#c0c1c4",textAlign:"center"}},"Введите новое имя пользователя и текущий пароль."),Cn.createElement(Ct.Z,{sx:{position:"absolute",top:"16px",right:"16px",cursor:"pointer","& svg":{fill:"#c0c1c4"},"& svg:hover, & svg:focus":{fill:"#ffffff"}},onClick:t},Cn.createElement(bn.Z,{sx:{}}))),Cn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"16px",padding:"0 16px 24px 16px"}},Cn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"8px"}},Cn.createElement(wt.Z,{sx:{fontSize:"14px",color:"#c0c1c4",textTransform:"uppercase"}},"Имя пользователя"),Cn.createElement(kt,{sx:{backgroundColor:"#36383a",".MuiOutlinedInput-input":{color:"#dfe0e1"},"input:-webkit-autofill":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:hover":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:focus":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:active":{boxShadow:"0 0 0 30px #36383a inset"}},type:"text",id:"name",name:"name",value:a,onChange:e=>l(e.target.value),autoComplete:"off",fullWidth:!0})),Cn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"8px"}},Cn.createElement(wt.Z,{sx:{fontSize:"14px",color:"#c0c1c4",textTransform:"uppercase"}},"Текущий пароль"),Cn.createElement(kt,{sx:{backgroundColor:"#36383a",".MuiOutlinedInput-input":{color:"#dfe0e1"},"input:-webkit-autofill":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:hover":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:focus":{boxShadow:"0 0 0 30px #36383a inset"},"input:-webkit-autofill:active":{boxShadow:"0 0 0 30px #36383a inset"}},type:"password",id:"password",name:"password",value:i,onChange:e=>s(e.target.value),autoComplete:"off",fullWidth:!0}))),Cn.createElement(Ct.Z,{sx:{display:"grid",justifyContent:"end",gridTemplateColumns:"repeat(2, max-content)",columnGap:"8px",padding:"16px",backgroundColor:"#43454a"}},Cn.createElement(It.Z,{sx:{display:"grid",alignItems:"center",color:"#ffffff",cursor:"pointer",padding:"2px 16px"},underline:"hover",onClick:()=>{l(null==n?void 0:n.name),s(""),t()}},Cn.createElement(wt.Z,{sx:{fontSize:"14px"}},"Отмена")),Cn.createElement(Kt,{sx:{textTransform:"initial"},variant:"contained",onClick:()=>{(null==a?void 0:a.trim())&&i.trim()&&(r(h({name:a,password:i})),t())}},"Готово"))))}));var _n=r(7294);const Sn=(0,gt.memo)((()=>{const e=(0,ft.s0)(),t=(0,o.v9)(Kr),[r,n]=(0,gt.useState)(!1),[a,l]=(0,gt.useState)(!1),[i,s]=(0,gt.useState)(!1);return(0,gt.useEffect)((()=>{const t=t=>{"Escape"===t.key&&e("friends")};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)}),[]),_n.createElement(Ct.Z,{sx:{position:"relative",display:"grid",padding:"60px 40px 80px 40px",alignContent:"start",backgroundColor:"#5e6065"}},_n.createElement(wn,{isOpen:a,onClose:()=>l(!1)}),_n.createElement(kn,{isOpen:i,onClose:()=>s(!1)}),_n.createElement(wt.Z,{sx:{paddingBottom:"20px",fontWeight:600,fontSize:"20px",lineHeight:"24px",color:"#ffffff"}},"Моя учетная запись"),_n.createElement(Ct.Z,{sx:{display:"grid",rowGap:"8px",position:"absolute",top:"60px",right:"-40px",textAlign:"center",cursor:"pointer","&:hover svg, &:focus svg":{fill:"#ffffff"}},onClick:()=>e("friends")},_n.createElement(cn.Z,{sx:{width:"36px",height:"36px",fill:"#b9bbbe"}}),_n.createElement(wt.Z,{sx:{fontSize:"13px",color:"#b9bbbe"}},"ESC")),_n.createElement(Ct.Z,{sx:{display:"grid"}},_n.createElement(Ct.Z,{sx:{backgroundColor:"#36383a",border:"1px solid#1c1e21",borderRadius:"4px",padding:"20px"}},_n.createElement(Ct.Z,null),_n.createElement(Ct.Z,{sx:{display:"grid",rowGap:"8px",justifyItems:"start"}},_n.createElement(wt.Z,{sx:{fontSize:"12px",color:"#c0c1c4",textTransform:"uppercase"}},"Неподтвержденный адрес эл.почты"),_n.createElement(wt.Z,{sx:{fontSize:"14px",color:"#dfe0e1"}},"Пожалуйста, проверьте свою электронную почту и следуйте инструкциям, чтобы подтвердить свой адресс электронной почты. Если вы не получили письмо или у него истек срок действия, вы можете попросить отправить новое."),_n.createElement(Kt,{sx:{textTransform:"none",backgroundColor:"#686d73","&:hover, &:focus":{backgroundColor:"#84888d"},"&:active":{backgroundColor:"#6b6e74"}},variant:"contained"},"Отправить письмо с подтверждением еще раз"))),_n.createElement(Ct.Z,{sx:{margin:"20px 0",backgroundColor:"#36383a",borderRadius:"4px",overflow:"hidden"}},_n.createElement(Ct.Z,{sx:{position:"relative",backgroundColor:(null==t?void 0:t.color)?t.color:null==t?void 0:t.default_color,height:"100px"}},_n.createElement(Ct.Z,{sx:{position:"absolute",top:"76px",left:"16px",width:"94px",height:"94px",backgroundImage:(null==t?void 0:t.image)?`url(${null==t?void 0:t.image})`:"none",backgroundColor:(null==t?void 0:t.color)?t.color:null==t?void 0:t.default_color,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%",border:"6px solid #36383a",borderRadius:"50%",cursor:"pointer"}},_n.createElement(Ct.Z,{sx:{width:"24px",height:"24px",backgroundColor:"online"===(null==t?void 0:t.status)?"#4caf50":"#ef5350",position:"absolute",bottom:0,right:0,borderRadius:"50%",border:"4px solid #36383a"}}))),_n.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",justifyContent:"space-between",alignItems:"center",padding:"16px 16px 16px 120px"}},_n.createElement(wt.Z,{sx:{fontSize:"20px",color:"#ffffff"}},null==t?void 0:t.name,_n.createElement(wt.Z,{component:"span",sx:{fontSize:"20px",color:"#c0c1c4"}},"#",null==t?void 0:t.id.slice(-4))),_n.createElement(Kt,{sx:{textTransform:"none"},variant:"contained",onClick:()=>e("/settings/user-profile")},"Настр. профиль пользователя")),_n.createElement(Ct.Z,{sx:{display:"grid",margin:"16px",padding:"16px",backgroundColor:"#43454a",borderRadius:"4px"}},_n.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",justifyContent:"space-between",alignItems:"center",padding:"8px 0"}},_n.createElement(Ct.Z,null,_n.createElement(wt.Z,{sx:{fontSize:"12px",color:"#c0c1c4",textTransform:"uppercase"}},"Имя пользователя"),_n.createElement(wt.Z,{sx:{fontSize:"16px",color:"#ffffff"}},null==t?void 0:t.name,_n.createElement(wt.Z,{component:"span",sx:{fontSize:"16px",color:"#c0c1c4",textTransform:"uppercase"}},"#",null==t?void 0:t.id.slice(-4)))),_n.createElement(Kt,{sx:{textTransform:"none",backgroundColor:"#686d73","&:hover, &:focus":{backgroundColor:"#84888d"},"&:active":{backgroundColor:"#6b6e74"}},variant:"contained",onClick:()=>l(!0)},"Изменить")),_n.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",justifyContent:"space-between",alignItems:"center",padding:"8px 0"}},_n.createElement(Ct.Z,null,_n.createElement(wt.Z,{sx:{fontSize:"12px",color:"#c0c1c4",textTransform:"uppercase"}},"Электронная почта"),_n.createElement(wt.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",columnGap:"8px",fontSize:"16px",color:"#ffffff"}},r?null==t?void 0:t.email:(e=>{const t=e.search("@");return Array(t).fill("*").join("")+e.slice(t)})(null==t?void 0:t.email),_n.createElement(It.Z,{sx:{cursor:"pointer",color:"#19b7f5"},underline:"hover",onClick:()=>n(!r)},_n.createElement(wt.Z,null,r?"Скрыть":"Показать")))),_n.createElement(Kt,{sx:{textTransform:"none",backgroundColor:"#686d73","&:hover, &:focus":{backgroundColor:"#84888d"},"&:active":{backgroundColor:"#6b6e74"}},variant:"contained",onClick:()=>s(!0)},"Изменить")),_n.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",justifyContent:"space-between",alignItems:"center",padding:"8px 0"}},_n.createElement(Ct.Z,null,_n.createElement(wt.Z,{sx:{fontSize:"12px",color:"#c0c1c4",textTransform:"uppercase"}},"Номер телефона"),_n.createElement(wt.Z,{sx:{fontSize:"16px",color:"#ffffff"}},"Вы еще не указали номер телефона.")),_n.createElement(Kt,{sx:{textTransform:"none",backgroundColor:"#686d73","&:hover, &:focus":{backgroundColor:"#84888d"},"&:active":{backgroundColor:"#6b6e74"}},variant:"contained",disabled:!0},"Изменить"))))))}));var In=r(7920),An=r(8646),Tn=r(9041),Gn=r(165),zn=r(542),On=r(6965),Rn=r(9149),jn=r(7294);const Ln=(0,gt.memo)((()=>{const e=(0,ft.s0)(),{state:t,stream:r,getUserMedia:n,stopUserMedia:o}=(()=>{const[e,t]=(0,gt.useState)(),[r,n]=(0,gt.useState)(),[o,a]=(0,gt.useState)(),l=()=>{r&&r.getTracks().forEach((e=>{e.stop()}))};return(0,gt.useEffect)((()=>()=>{l()}),[r]),{state:e,stream:r,error:o,getUserMedia:e=>xn(void 0,null,(function*(){try{t("pending");const r=yield navigator.mediaDevices.getUserMedia(e);t("fulfilled"),n(r)}catch(e){t("rejected"),a(e)}})),stopUserMedia:l}})(),{audioInDevices:a,audioOutDevices:l,videoInDevices:s,getDeviceInfo:c}=(()=>{const[e,t]=(0,gt.useState)(),[r,n]=(0,gt.useState)([]),[o,a]=(0,gt.useState)([]),[l,i]=(0,gt.useState)([]),[s,c]=(0,gt.useState)();return{state:e,audioInDevices:r,audioOutDevices:o,videoInDevices:l,error:s,getDeviceInfo:()=>xn(void 0,null,(function*(){try{t("pending");const e=yield navigator.mediaDevices.enumerateDevices();t("fulfilled");const r=e.filter((e=>"audioinput"===e.kind)),o=e.filter((e=>"audiooutput"===e.kind)),l=e.filter((e=>"videoinput"===e.kind));n(r),a(o),i(l)}catch(e){t("rejected"),c(e)}}))}})(),[d,p]=(0,gt.useState)(""),[u,m]=(0,gt.useState)(""),[g,f]=(0,gt.useState)(""),[x,v]=(0,gt.useState)(!1),[h,E]=(0,gt.useState)(!1),b=(0,gt.useRef)(),y=(0,gt.useRef)();return(0,gt.useEffect)((()=>{a.length>0&&p(a[0].deviceId),l.length>0&&m(l[0].deviceId),s.length>0&&f(s[0].deviceId)}),[a,l,s]),(0,gt.useEffect)((()=>{"fulfilled"===t&&c()}),[t]),(0,gt.useEffect)((()=>{c(),n({audio:!0,video:!1})}),[]),(0,gt.useEffect)((()=>{if("fulfilled"===t&&r&&y.current&&b.current){const e=new MediaStream(r.getAudioTracks()),t=new MediaStream(r.getVideoTracks());y.current.srcObject=e,b.current.srcObject=t}return()=>{y.current&&b.current&&(y.current.srcObject=null,b.current.srcObject=null)}}),[t,r]),jn.createElement(Ct.Z,{sx:{position:"relative",display:"grid",padding:"60px 40px 80px 40px",alignContent:"start",backgroundColor:"#5e6065"}},jn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"8px",position:"absolute",top:"60px",right:"-40px",textAlign:"center",cursor:"pointer","&:hover svg, &:focus svg":{fill:"#ffffff"}},onClick:()=>e("/friends")},jn.createElement(cn.Z,{sx:{width:"36px",height:"36px",fill:"#b9bbbe"}}),jn.createElement(wt.Z,{sx:{fontSize:"13px",color:"#b9bbbe"}},"ESC")),jn.createElement(wt.Z,{className:i.iv`
          padding-bottom: 20px !important;
          font-weight: 600 !important;
          font-size: 20px !important;
          line-height: 24px !important;
          color: #ffffff !important;
        `},"Насройки голоса"),jn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, 320px)",alignItems:"center",columnGap:"16px",marginBottom:"16px"}},jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Устройство ввода"),jn.createElement(In.Z,{id:"audioInDevice",value:d||"default",onChange:e=>p(e.target.value),fullWidth:!0},a.map((e=>jn.createElement(Pr.Z,{key:e.deviceId,sx:{maxWidth:"320px",whiteSpace:"normal"},value:e.deviceId||"default"},e.label||"Default"))))),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Устройство вывода"),jn.createElement(In.Z,{id:"audioOutDevice",value:u||"default",onChange:e=>m(e.target.value),fullWidth:!0},l.map((e=>jn.createElement(Pr.Z,{key:e.deviceId,sx:{maxWidth:"320px",whiteSpace:"normal"},value:e.deviceId||"default"},e.label||"Default"))))),jn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, 320px)",alignItems:"center",columnGap:"16px",marginBottom:"16px"}},jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Громкость микрофона"),jn.createElement(An.ZP,{defaultValue:100,valueLabelDisplay:"auto",max:100})),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Громкость звука"),jn.createElement(An.ZP,{defaultValue:100,valueLabelDisplay:"auto",max:200})))),jn.createElement(Ct.Z,{sx:{display:"grid",marginBottom:"16px"}},jn.createElement(wt.Z,null,"Проверка микрофона"),jn.createElement(wt.Z,{variant:"caption"},"Проблемы с микрофоном? Начните проверку и скажите какую-нибудь ерунду - мы тут же ее воспроизведем."),jn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"max-content 1fr",alignItems:"center",columnGap:"8px"}},jn.createElement(Kt,{variant:"contained",onClick:()=>v(!x)},x?"Прекратить проверку":"Давайте проверим"),jn.createElement(Ct.Z,null,jn.createElement(Tn.Z,{variant:"determinate",value:0}),x&&jn.createElement(wt.Z,{variant:"caption"},"Воспроизводим ваш прекрасный голос")),jn.createElement(Ct.Z,{component:"audio",ref:y,autoPlay:!0,muted:!x})),jn.createElement(wt.Z,{variant:"caption"},"Нужна помощь с голосовым или видеочатом? Ознакомьтесь с нашим"," ",jn.createElement(It.Z,null,"руководством по устранению неполадок"),".")),jn.createElement(nr.Z,{sx:{margin:"32px 0",borderColor:Ot.palette.grey[800]}}),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Режим ввода"),jn.createElement(Gn.Z,{defaultValue:"voice"},jn.createElement(zn.Z,{value:"voice",control:jn.createElement(On.Z,null),label:"Активация по голосу"}),jn.createElement(zn.Z,{value:"button",control:jn.createElement(On.Z,null),label:"Режим рации (ограниченный)"}))),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Чувствительнось ввода"),jn.createElement(An.ZP,{defaultValue:40,valueLabelDisplay:"auto",max:100})),jn.createElement(nr.Z,{sx:{margin:"32px 0",borderColor:Ot.palette.grey[800]}}),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,{className:i.iv`
            font-weight: 600 !important;
            font-size: 20px !important;
            line-height: 24px !important;
            color: #ffffff !important;
          `},"Насройки видео"),jn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"16px"}},jn.createElement(Ct.Z,{sx:{position:"relative",width:"100%",height:"220px",backgroundColor:Ot.palette.grey[500],display:"grid",alignItems:"center",justifyContent:"center",borderRadius:"8px",boxShadow:`inset 0 0 0 1px ${Ot.palette.grey[800]}`}},jn.createElement(Ct.Z,{sx:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},component:"video",ref:b,autoPlay:!0,muted:!0}),!h&&jn.createElement(Kt,{variant:"contained",onClick:()=>{n({audio:!0,video:!0}),E(!0)}},"Проверить видео"),h&&jn.createElement(Kt,{variant:"contained",onClick:()=>{o(),E(!1)}},"Остановть проверку")))),jn.createElement(Ct.Z,null,jn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",alignItems:"center",justifyContent:"space-between"}},jn.createElement(wt.Z,null,"Препросмотр видео (всегда)"),jn.createElement(Rn.Z,{checked:!1})),jn.createElement(wt.Z,null,"Использовать предпросмотр каждый раз, как вы включаете видео")),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Камера"),jn.createElement(In.Z,{id:"videoInDevice",value:g||"default",onChange:e=>f(e.target.value),fullWidth:!0},s.map((e=>jn.createElement(Pr.Z,{key:e.deviceId,sx:{maxWidth:"320px",whiteSpace:"normal"},value:e.deviceId||"default"},e.label||"Default"))))),jn.createElement(nr.Z,{sx:{margin:"32px 0",borderColor:Ot.palette.grey[800]}}),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Расширенные"),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Аудио кодек"),jn.createElement(Ct.Z,{sx:{border:"1px solid #000000"}},jn.createElement(wt.Z,null,"Video Calls использует отборный, органический, выращенный на домашней грядке голосовой кодек Opus,"))),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Обработка голоса"),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Эхоподавление"),jn.createElement(Rn.Z,{checked:!0})),jn.createElement(nr.Z,{sx:{margin:"8px 0",borderColor:Ot.palette.grey[800]}}),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Шумоподавление"),jn.createElement(Rn.Z,{checked:!1})),jn.createElement(nr.Z,{sx:{margin:"8px 0",borderColor:Ot.palette.grey[800]}}),jn.createElement(Ct.Z,null,jn.createElement(wt.Z,null,"Автоматическа регулировка усиления"),jn.createElement(Rn.Z,{checked:!0})),jn.createElement(nr.Z,{sx:{margin:"8px 0",borderColor:Ot.palette.grey[800]}})),jn.createElement(Ct.Z,null,jn.createElement(Kt,{variant:"outlined",color:"error"},"Сбросить голосовые настройки"))))}));var Pn=r(6421),Fn=r(7294),Mn=Object.defineProperty,Dn=Object.getOwnPropertySymbols,qn=Object.prototype.hasOwnProperty,$n=Object.prototype.propertyIsEnumerable,Wn=(e,t,r)=>t in e?Mn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const Un=(0,gt.forwardRef)(((e,t)=>{var r=e,{children:n}=r,o=((e,t)=>{var r={};for(var n in e)qn.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Dn)for(var n of Dn(e))t.indexOf(n)<0&&$n.call(e,n)&&(r[n]=e[n]);return r})(r,["children"]);return Fn.createElement(Ct.Z,null,Fn.createElement(Ct.Z,((e,t)=>{for(var r in t||(t={}))qn.call(t,r)&&Wn(e,r,t[r]);if(Dn)for(var r of Dn(t))$n.call(t,r)&&Wn(e,r,t[r]);return e})({component:"video",ref:t},o),n))})),Bn=(0,gt.memo)(Un);var Nn=r(7294),Vn=(e,t,r)=>new Promise(((n,o)=>{var a=e=>{try{i(r.next(e))}catch(e){o(e)}},l=e=>{try{i(r.throw(e))}catch(e){o(e)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,l);i((r=r.apply(e,t)).next())}));const Hn=(0,gt.memo)((()=>{var e,t,r,n,a,l;const i=(0,o.I0)(),s=(0,ft.s0)(),{user:c,media:d}=(0,o.v9)((e=>e.user)),{meet:p}=(0,o.v9)((e=>e.meet)),[u,m]=(0,gt.useState)(),[g,f]=(0,gt.useState)({audio:!0,video:!0}),[x,v]=(0,gt.useState)("new"),h=(0,gt.useRef)(null),E=(0,gt.useRef)(null),b=(0,gt.useRef)(null),y=(0,gt.useRef)(null),Z=(null==(e=p.user)?void 0:e.id)?p.user.id:"",k=p.isInitiator;(0,gt.useEffect)((()=>(console.log("LOGS: Получение медиапотока с устройств."),console.log(`LOGS: Пользователь инициатор: ${k}`),Vn(void 0,null,(function*(){const e=yield navigator.mediaDevices.getUserMedia({video:!0,audio:!0});return m(e),{stream:e}})),i(_({audio:!0,video:!0})),i(dt({meetState:"new"})),()=>{Ge.removeListener("server:media_state_change"),Ge.removeListener("server:meet_accept_call"),Ge.removeListener("server:meet_offer"),Ge.removeListener("server:meet_answer"),Ge.removeListener("server:meet_candidate"),Ge.removeListener("server:meet_end_call")})),[]),(0,gt.useEffect)((()=>{b.current&&y.current&&(g.video?y.current&&(b.current.srcObject=y.current):b.current.srcObject=null)}),[u,g]),(0,gt.useEffect)((()=>{u&&(h.current&&console.log("senders",h.current.getSenders()),d.audio?h.current&&h.current.getSenders()[0].replaceTrack(u.getAudioTracks().slice().map((e=>(e.enabled=!0,e)))[0]||null):h.current&&h.current.getSenders()[0].replaceTrack(u.getAudioTracks().slice().map((e=>(e.enabled=!1,e)))[0]||null),d.video?h.current&&h.current.getSenders()[1].replaceTrack(u.getVideoTracks().slice().map((e=>(e.enabled=!0,e)))[0]||null):h.current&&h.current.getSenders()[1].replaceTrack(u.getVideoTracks().slice().map((e=>(e.enabled=!1,e)))[0]||null))}),[u,d]),(0,gt.useEffect)((()=>(u&&(console.log("LOGS: Когда медиапоток и ID пользователя готовы."),E.current&&(console.log("LOGS: Добавление медиапотока в видео пользователя который звонит."),E.current.srcObject=u),(null==c?void 0:c.id)&&Z&&(k&&(console.log("LOGS: Отправка события начала вызова."),Ge.emit("client:meet_start_call",{userFromCall:c.id,userToCall:Z})),k||(console.log("LOGS: Отправка события принятия вызова."),Ge.emit("client:meet_accept_call",{userFromCall:c.id,userToCall:Z}))),Ge.on("server:media_state_change",(e=>{f(e.media)})),Ge.on("server:meet_accept_call",(()=>{h.current?console.log("LOGS: Соединение уже установленно."):k?(console.log("LOGS: Начало установки соединения между пользователями."),w()):console.log("LOGS: Пользователь инициатор вызова.")})),Ge.on("server:meet_offer",((e,t)=>{S(e.userFromCall,e.userToCall,t)})),Ge.on("server:meet_answer",((e,t,r)=>{I(e,t,r)})),Ge.on("server:meet_candidate",((e,t,r)=>{A(r)})),Ge.on("server:meet_end_call",(()=>{h.current&&(i(dt({meetState:"disconnected"})),i(_({audio:!0,video:!0})),T(),s("/"))}))),()=>{u&&u.getTracks().forEach((e=>{e.stop(),e.enabled=!1}))})),[u,c,p]);const C=()=>{u&&(h.current=new RTCPeerConnection({iceServers:[{urls:"stun:openrelay.metered.ca:80"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443?transport=tcp",username:"openrelayproject",credential:"openrelayproject"}]}),h.current.onicecandidate=e=>{Ge.emit("client:meet_candidate",null==c?void 0:c.id,Z,e.candidate),console.log("LOGS: icecandidate event",e)},h.current.onconnectionstatechange=()=>{h.current&&(v(h.current.iceConnectionState),i(dt({meetState:h.current.iceConnectionState})))},h.current.ontrack=e=>{console.log("LOGS: ontrack event",e),console.log("EVENT_STREAMS",e.streams[0].getVideoTracks(),e.streams[0].getAudioTracks()),b.current&&(y.current=e.streams[0],b.current.srcObject=e.streams[0])},console.log("LOGS: stream",u),u.getTracks().forEach((e=>{var t;console.log("LOGS: track",e),null==(t=h.current)||t.addTrack(e,u)})),console.log("LOGS: createPeerConnection",h.current))},w=()=>Vn(void 0,null,(function*(){try{if(console.log("LOGS: Создание peer соединения."),C(),h.current){console.log("LOGS: Создание предложения для peer соединения.");const e=yield h.current.createOffer();(null==c?void 0:c.id)&&Z&&(console.log("LOGS: Отправка предложения другому пользователю."),Ge.emit("client:meet_offer",{userFromCall:c.id,userToCall:Z},e)),console.log("LOGS: Установка предложения пользователю локально для peer соединения."),yield h.current.setLocalDescription(e)}}catch(e){console.error(e)}})),S=(e,t,r)=>Vn(void 0,null,(function*(){try{if(console.log("LOGS: Установка peer соединения для обработки предложения."),C(),h.current){console.log("LOGS: Установка удаленного предложения peer соединения."),yield h.current.setRemoteDescription(r),console.log("LOGS: Создание ответа peer соединения.");const n=yield h.current.createAnswer();console.log("LOGS: Событие отправки ответа peer соединения."),Ge.emit("client:meet_answer",t,e,n),console.log("LOGS: Установка локального ответа peer соединения."),yield h.current.setLocalDescription(n)}}catch(e){console.error(e)}})),I=(e,t,r)=>Vn(void 0,null,(function*(){h.current?yield h.current.setRemoteDescription(r):console.error("Peer соединение не установлено.")})),A=e=>Vn(void 0,null,(function*(){h.current?(console.log("LOGS: Кандидат",e),e&&e.candidate?yield h.current.addIceCandidate(e):yield h.current.addIceCandidate(void 0)):console.error("Соединение не установлено.")})),T=()=>{h.current&&(h.current.close(),h.current=null),E.current&&(E.current.srcObject=null),Ge.emit("client:meet_end_call",Z),i(dt({meetState:"new"})),s("/")};return Nn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"72px 376px 1fr",height:"100%",backgroundColor:Ot.palette.common.white}},Nn.createElement(Ct.Z,{sx:{backgroundColor:Ot.palette.grey[200]}},Nn.createElement(ar,null)),Nn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateRows:"72px max-content 1fr 64px",backgroundColor:Ot.palette.grey[400],overflow:"hidden"}},Nn.createElement(Ct.Z,{sx:{padding:"24px 20px",borderBottom:`1px solid ${Ot.palette.grey[600]}`}},Nn.createElement(wt.Z,{variant:"h6"},"Личные сообщения")),Nn.createElement(Ct.Z,{sx:{padding:"16px"}},Nn.createElement(Kt,{fullWidth:!0,variant:"contained",onClick:()=>s("/friends")},"Друзья")),Nn.createElement(Ct.Z,{sx:{margin:"28px 4px",overflowY:"scroll","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{backgroundColor:"none"},"&::-webkit-scrollbar-thumb":{backgroundColor:Ot.palette.grey[300],border:`1px solid ${Ot.palette.grey[500]}`,borderRadius:"8px"}}},Nn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"12px",padding:"0 4px"}})),Nn.createElement(wr,null)),Nn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateRows:"72px 1fr",backgroundColor:Ot.palette.grey[500],overflow:"hidden"}},Nn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",columnGap:"24px",padding:"16px 24px",borderBottom:`1px solid ${Ot.palette.grey[400]}`,alignItems:"center"}},Nn.createElement(wt.Z,{variant:"h6"},"Встреча")),Nn.createElement(Ct.Z,{sx:{display:"grid",width:"100%",height:"100%",padding:"16px",position:"relative",alignItems:"center",justifyContent:"center",gridTemplateColumns:"1fr"}},Nn.createElement(Ct.Z,{sx:{position:"relative",width:"640px",height:"360px",alignSelf:"center",justifySelf:"center",overflow:"hidden"}},Nn.createElement(Bn,{sx:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:(null==(t=p.user)?void 0:t.color)?p.user.color:Ot.palette.grey[700],objectFit:"cover",borderRadius:"8px",zIndex:1},ref:b,autoPlay:!0}),Nn.createElement(Ct.Z,{sx:{width:"100%",height:"64px",position:"absolute",bottom:"0",left:"0",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.35) 100%)",zIndex:2}}),Nn.createElement(Bn,{ref:E,sx:{display:d.video?"grid":"none",position:"absolute",top:"16px",right:"16px",width:"128px",height:"72px",backgroundColor:Ot.palette.grey[700],objectFit:"cover",borderRadius:"8px",zIndex:2},autoPlay:!0,muted:!0}),("connected"!==x||!g.video)&&Nn.createElement(ir.Z,{sx:{position:"absolute",width:"100px",height:"100px",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2,backgroundColor:(null==(r=p.user)?void 0:r.color)?p.user.color:null==(n=p.user)?void 0:n.default_color,boxShadow:"0 0 16px 4px rgb(0 0 0 / 25%)"},src:(null==(a=p.user)?void 0:a.image)?p.user.image:""}),"new"===x?Nn.createElement(wt.Z,{variant:"body2",sx:{position:"absolute",bottom:"88px",left:"50%",transform:"translateX(-50%)",zIndex:2,color:"#ffffff"}},"Звоним пользователю ",(null==(l=p.user)?void 0:l.name)?p.user.name:"Неизвестный пользователь","..."):"checking"===x?Nn.createElement(wt.Z,{variant:"body2",sx:{position:"absolute",bottom:"88px",left:"50%",transform:"translateX(-50%)",zIndex:2,color:"#ffffff"}},"Подключение..."):null,u&&"connected"===x&&Nn.createElement(Ct.Z,{sx:{position:"absolute",bottom:"0",left:"0",width:"100%",display:"grid",gridTemplateColumns:"repeat(3, max-content)",alignItems:"center",justifyContent:"center",columnGap:"8px",padding:"16px 0",zIndex:2}},Nn.createElement(St.Z,{sx:{minWidth:"32px",minHeight:"32px",width:"32px",height:"32px",borderRadius:"50%"}},g.audio?Nn.createElement(pr.Z,{sx:{color:Ot.palette.common.white,width:"16px",height:"16px"}}):Nn.createElement(ur.Z,{sx:{color:Ot.palette.grey[700]}})),Nn.createElement(Kt,{variant:"contained",color:"error",sx:{minWidth:"32px",minHeight:"32px",width:"32px",height:"32px",borderRadius:"50%"},onClick:()=>{T()}},Nn.createElement(Pn.Z,{sx:{color:Ot.palette.common.white,width:"16px",height:"16px"}})),Nn.createElement(St.Z,{sx:{minWidth:"32px",minHeight:"32px",width:"32px",height:"32px",borderRadius:"50%"}},g.video?Nn.createElement(mr.Z,{sx:{color:Ot.palette.common.white,width:"16px",height:"16px"}}):Nn.createElement(gr.Z,{sx:{color:Ot.palette.grey[700]}})))))))}));var Yn=r(7294);const Xn=(0,gt.memo)((()=>Yn.createElement(ft.Z5,null,Yn.createElement(ft.AW,{path:"friends",element:Yn.createElement(Sr,null)},Yn.createElement(ft.AW,{index:!0,element:Yn.createElement(ft.Fg,{to:"online"})}),Yn.createElement(ft.AW,{path:"online",element:Yn.createElement(Vr,null)}),Yn.createElement(ft.AW,{path:"all",element:Yn.createElement(Br,null)}),Yn.createElement(ft.AW,{path:"invitations",element:Yn.createElement(Jr,null)}),Yn.createElement(ft.AW,{path:"blocked",element:Yn.createElement(nn,null)}),Yn.createElement(ft.AW,{path:"add",element:Yn.createElement(sn,null)})),Yn.createElement(ft.AW,{path:"settings",element:Yn.createElement(Gr,null)},Yn.createElement(ft.AW,{path:"user-account",element:Yn.createElement(Sn,null)}),Yn.createElement(ft.AW,{path:"user-profile",element:Yn.createElement(En,null)}),Yn.createElement(ft.AW,{path:"voice-and-video",element:Yn.createElement(Ln,null)})),Yn.createElement(ft.AW,{path:"channels",element:Yn.createElement(jr,null)}),Yn.createElement(ft.AW,{path:"meet"},Yn.createElement(ft.AW,{index:!0,element:Yn.createElement(Hn,null)})),Yn.createElement(ft.AW,{path:"*",element:Yn.createElement(ft.Fg,{to:"friends/online"})}))));var Jn=r(7294);const Kn=(0,gt.memo)((({isAuthorizated:e})=>e?Jn.createElement(Xn,null):Jn.createElement(Wt,null)));var Qn=r(7294);const eo=(0,gt.memo)((({open:e,onClose:t,user:r})=>{const n=(0,o.I0)(),a=(0,ft.s0)();return Qn.createElement(yn.Z,{open:e,onClose:t},Qn.createElement(Ct.Z,{sx:{display:"grid",rowGap:"32px",alignItems:"center",background:"#ffffff",borderRadius:"8px",padding:"16px 32px",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},Qn.createElement(wt.Z,null,"Вам звонит пользователь: ",(null==r?void 0:r.name)?r.name:"Неизвестный"),Qn.createElement(Ct.Z,{sx:{display:"grid",gridTemplateColumns:"repeat(2, max-content)",alignItems:"center",justifyContent:"center",columnGap:"16px"}},Qn.createElement(Kt,{variant:"contained",color:"success",onClick:()=>{n(ct({user:r,isInitiator:!1})),(null==r?void 0:r.id)&&a("/meet"),t()}},"Ответить"),Qn.createElement(Kt,{variant:"contained",color:"error",onClick:()=>{(null==r?void 0:r.id)&&Ge.emit("client:meet_end_call",r.id),t()}},"Отклонить"))))}));var to=r(7294);const ro=()=>{const e=(0,o.I0)(),{authorizated:t}=(0,o.v9)((e=>e.authorization)),{user:r}=(0,o.v9)((e=>e.user)),[n,a]=(0,gt.useState)(!1),[l,i]=(0,gt.useState)(null);return(0,gt.useEffect)((()=>{if(localStorage.getItem("access_token")){const t=localStorage.getItem("refresh_token");t&&e(H({refresh_token:t}))}}),[]),(0,gt.useEffect)((()=>{t&&(e(f()),Ge.on(R,(()=>{e(f())})),Ge.on("server:meet_start_call",(e=>{a(!0),i(e.userFromCall),console.log(`LOGS: Входящий вызов от пользователя: ${e.userFromCall.name}`)})),Ge.on("server:meet_end_call",(()=>{a(!1),console.log("LOGS: Входящий вызов от пользователя отклонен.")})))}),[t]),(0,gt.useEffect)((()=>{if(null==r?void 0:r.id){Ge.emit(z,r.id);const e=()=>{Ge.emit(z,r.id),console.log("Client status: online")},t=()=>{console.log("Client status: offline")};window.addEventListener("online",e),window.addEventListener("offline",t)}}),[null==r?void 0:r.id]),to.createElement(to.Fragment,null,to.createElement(Kn,{isAuthorizated:t}),to.createElement(eo,{open:n,onClose:()=>{a(!1)},user:l}))};var no=r(3362),oo=r(7294);const ao=()=>(i.hi`
    *,
    *::before,
    *::after {
      box-sizing: inherit;
    }

    html {
      box-sizing: border-box;
    }

    html,
    body,
    .root {
      height: 100%;
    }

    body {
      margin: 0;
      background: radial-gradient(105.05% 99.28% at 50% 29.72%, #8c9eff 0%, #536dfe 42.9%, #536dfe 61.7%, #3d5afe 84.71%, #304ffe 100%);
      background-repeat: no-repeat;
    }

    input:-webkit-autofill,
    input:-webkit-autofill:hover,
    input:-webkit-autofill:focus,
    input:-webkit-autofill:active {
      box-shadow: 0 0 0 30px #ffffff inset;
    }
  `,(0,no.D)(),oo.createElement(o.zt,{store:mt},oo.createElement(l.Z,{theme:Ot},oo.createElement(a.UT,null,oo.createElement(ro,null),oo.createElement(vn.Ix,{theme:"light"})))));(0,n.render)(oo.createElement(ao,null),document.querySelector(".root"))}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,n),a.exports}n.m=t,e=[],n.O=(t,r,o,a)=>{if(!r){var l=1/0;for(d=0;d<e.length;d++){for(var[r,o,a]=e[d],i=!0,s=0;s<r.length;s++)(!1&a||l>=a)&&Object.keys(n.O).every((e=>n.O[e](r[s])))?r.splice(s--,1):(i=!1,a<l&&(l=a));if(i){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[r,o,a]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e+"../"})(),(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,a,[l,i,s]=r,c=0;if(l.some((t=>0!==e[t]))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(s)var d=s(n)}for(t&&t(r);c<l.length;c++)a=l[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(d)},r=globalThis.webpackChunkvideo_calls=globalThis.webpackChunkvideo_calls||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var o=n.O(void 0,[56],(()=>n(5768)));o=n.O(o)})();
//# sourceMappingURL=main.d2bbad6c453981d3e05a.js.map